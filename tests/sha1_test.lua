local sha1 = require'sha1'.sha1
local fromhex = require'glue'.fromhex

local function eq(a, b)
	a = fromhex(a)
	assert(a == b)
end

eq("da39a3ee5e6b4b0d3255bfef95601890afd80709", sha1(""))
eq("bb2fa3ee7afb9f54c6dfb5d021f14b1ffe40c163", sha1(("x"):rep(64)))
eq("cef734ba81a024479e09eb5a75b6ddae62e6abf1", sha1(("x"):rep(55)))
eq("7f103bf600de51dfe91062300c14738b32725db5", sha1("http://regex.info/blog/"))
eq("a080cbda64850abb7b7f67ee875ba068074ff6fe", sha1(string.rep("a", 10000)))
eq("a9993e364706816aba3e25717850c26c9cd0d89d", sha1("abc"))
eq("84983e441c3bd26ebaae4aa1f95129e5e54670f1", sha1("abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq"))
eq("2fd4e1c67a2d28fced849ee1bb76e7391b93eb12", sha1("The quick brown fox jumps over the lazy dog"))
eq("de9f2c7fd25e1b3afad3e85a0bd17d9b100db4b3", sha1("The quick brown fox jumps over the lazy cog"))

eq("efb750130b6cc9adf4be219435e575442ec68b7c", sha1(string.char(136,43,218,202,158,86,64,140,154,173,20,184,170,125,37,54,208,68,171,24,164,89,142,111,148,235,187,181,122):rep(76)))
eq("432dff9d4023e13194170287103d0377ed182d96", sha1(string.char(20,174):rep(407)))
eq("ccba5c47946530726bb86034dbee1dbf0c203e99", sha1(string.char(20,54,149,252,176,4,96,100,223):rep(753)))
eq("4d6fea4f8576cd6648ae2d2ee4dc5df0a8309115", sha1(string.char(118,171,221,33,54,209,223,152,35,67,88,50):rep(985)))
eq("f560412aabf813d01f15fdc6650489584aabd266", sha1(string.char(23,85,29,13,146,55,164,14,206,196,109,183,53,92,97,123,242,220,112,15,43,113,22,246,114,29,209,219,190):rep(177)))
eq("b56795e12f3857b3ba1cbbcedb4d92dd9c419328", sha1(string.char(21,216):rep(131)))
eq("54f292ecb7561e8ce27984685b427234c9465095", sha1(string.char(15,205,12,181,4,114,128,118,219):rep(818)))
eq("fe265c1b5a848e5f3ada94a7e1bb98a8ce319835", sha1(string.char(136,165,10,46,167,184,86,255,58,206,237,21,255,15,198,211,145,112,228,146,26,69,92,158,182,165,244,39,152):rep(605)))
eq("96f186998825075d528646059edadb55fdd96659", sha1(string.char(100,226,28,248,132,70,221,54,92,181,82,128,191,12,250,244):rep(94)))
eq("e29c68e4d6ffd3998b2180015be9caee59dd8c8a", sha1(string.char(247,14,15,163,0,53,50,113,84,121):rep(967)))
eq("6d2332a82b3600cbc5d2417f944c38be9f1081ae", sha1(string.char(93,98,119,201,41,27,89,144,25,141,117,26,111,132):rep(632)))
eq("d84a91da8fb3aa7cd59b99f347113939406ef8eb", sha1(string.char(28,252,0,4,150,164,91):rep(568)))
eq("8edf1b92ad5a90ed762def9a873a799b4bda97f9", sha1(string.char(166,67,113,111,161,253,169,195,158,97,96,150,49,219,103,16,186,184,37,109,228,111):rep(135)))
eq("d5b2c7019f9ff2f75c38dc040c827ab9d1a42157", sha1(string.char(38,252,110,224,168,60,2,133,8,153,200,0,199,104,191,62,28,168,73,48,199,217,83):rep(168)))
eq("5aeb57041bfada3b72e3514f493d7b9f4ca96620", sha1(string.char(57):rep(738)))
eq("4548238c8c2124c6398427ed447ae8abbb8ead27", sha1(string.char(221,131,171):rep(230)))
eq("ed0960b87a790a24eb2890d8ea8b18043f1a87d5", sha1(string.char(151,113,144,19,249,148,75,51,164,233,102,232,3,58,81,99,101,255,93,231,147,150,212,216,109,62):rep(110)))
eq("d7ac6233298783af55901907bb99c13b2afbca99", sha1(string.char(44,239,189,203,196,79,82,143,99,21,125,75,167,26,108,161,9,193,72):rep(919)))
eq("43600b41a3c5267e625bbdfde95027429c330c60", sha1(string.char(122,70,129,24,192,213,205,224,62,79,81,129,22,171):rep(578)))
eq("5816df09a78e4594c1b02b170aa57333162def38", sha1(string.char(76,103,48,150,115,161,86,42,247,82,197,213,155,108,215,18,119):rep(480)))
eq("ef7903b1e811a086a9a5a5142242132e1367ae1d", sha1(string.char(143,70):rep(65)))
eq("6e16b2dac71e338a4bd26f182fdd5a2de3c30e6c", sha1(string.char(130,114,144,219,245,72,205,44,149,68,150,169,243):rep(197)))
eq("6cc772f978ca5ef257273f046030f84b170f90c9", sha1(string.char(26,49,141,64,30,61,12):rep(362)))
eq("54231fc19a04a64fc1aa3dce0882678b04062012", sha1(string.char(76,252,160,253,253,167,27,179,237,15,219,46,141,255,23,53,184,190,233,125,211,11):rep(741)))
eq("5511a993b808e572999e508c3ce27d5f12bb4730", sha1(string.char(197,139,184,188,200,31,171,236,252,147,123,75,7,138,111,167,68,114,73,80,51,233,241,233,91):rep(528)))
eq("64c4577d4763c95f47ac5d21a292836a34b8b124", sha1(string.char(177,114,100,216,18,57,2,110,108,60,81,80,253,144,179,47,228,42,105,72,86,18,30,167):rep(901)))
eq("bb0467117e3b630c2b3d9cdf063a7e6766a3eae1", sha1(string.char(249,99,174,228,15,211,121,152,203,115,197,198,66,17,196,6,159,170,116):rep(800)))
eq("1f9c66fca93bc33a071eef7d25cf0b492861e679", sha1(string.char(205,64,237,65,171,0,176,17,104,6,101,29,128,200,214,24,32,91,115,71,26,11,226,69,141,83,249,129):rep(288)))
eq("55d228d9bfd522105fe1e1f1b5b09a1e8ee9f782", sha1(string.char(96,37,252,185,137,194,215,191,190,235,73,224,125,18,146,74,32,82,58,95,49,102,85,57,241,54,55):rep(352)))
eq("58c3167e666bf3b4062315a84a72172688ad08b1", sha1(string.char(65,91,96,147,212,18,32,144,138,187,70,26,105,42,71,13,229,137,185,10,86,124,171,204,104,42,2,172):rep(413)))
eq("f97936ca990d1c11a9967fd12fc717dcd10b8e9e", sha1(string.char(253,159,59,76,230,153,22,198,15,9,223,3,31):rep(518)))
eq("5d15229ad10d2276d45c54b83fc0879579c2828e", sha1(string.char(149,20,176,144,39,216,82,80,56,38,152,49,167,120,222,20,26,51,157,131,160,52,6):rep(895)))
eq("3757d3e98d46205a6b129e09b0beefaa0e453e64", sha1(string.char(120,131,113,78,7,19,59,120,210,220,73,118,36,240,64,46,149,3,120,223,80,232,255,212,250,76,109,108,133):rep(724)))
eq("5e62539caa6c16752739f4f9fd33ca9032fff7e1", sha1(string.char(216,240,166,165,2,203,2,189,137,219,231,229):rep(61)))
eq("3ff1c031417e7e9a34ce21be6d26033f66cb72c9", sha1(string.char(4,178,215,183,17,198,184,253,137,108,178,74,244,126,32):rep(942)))
eq("8c20831fc3c652e5ce53b9612878e0478ab11ee6", sha1(string.char(115,157,59,188,221,67,52,151,147,233,84,30,243,250,109,103,101,0,219,13,176,38,21):rep(767)))
eq("09c7c977cb39893c096449770e1ed75eebb9e5a1", sha1(string.char(184,131,17,61,201,164,19,25,36,141,173,74,134,132,104,23,104,136,121,232,12,203,115,111,54,114,251,223,61,126):rep(458)))
eq("9534d690768bc85d2919a059b05561ec94547fc2", sha1(string.char(49,93,136,112,92,42,117,28,31):rep(187)))
eq("7dfca0671de92a62de78f63c0921ff087f2ba61d", sha1(string.char(194,78,252,112,175,6,26,103,4,47,195,99,78,130,40,58,84,175,240,180,255,108,3,42,51,111,35,49,217,160):rep(72)))
eq("62bf20c51473c6a0f23752e369cabd6c167c9415", sha1(string.char(28,126,243,196,155,31,158,50):rep(166)))
eq("2ece95e43aba523cdbf248d07c05f569ecd0bd12", sha1(string.char(76,230,117,248,231,228):rep(294)))
eq("722752e863386b737f29a08f23a0ec21c4313519", sha1(string.char(61,102,1,118):rep(470)))
eq("a638db01b5af10a828c6e5b73f4ca881974124a0", sha1(string.char(130,8,4):rep(768)))
eq("54c7f932548703cc75877195276bc2aa9643cf9b", sha1(string.char(193,232,122,142,213,243,224,29,201,6,127,45,4,36,92,200,148,111,106,110,221,235,197,51,66,221,123,155,222,186):rep(290)))
eq("ecfc29397445d85c0f6dd6dc50a1272accba0920", sha1(string.char(221,76,21,148,12,109,232,113,230,110,96,82,36):rep(196)))
eq("31d966d9540f77b49598fa22be4b599c3ba307aa", sha1(string.char(148,237,212,223,44,133,153):rep(53)))
eq("9f97c8ace98db9f61d173bf2b705404eb2e9e283", sha1(string.char(190,233,29,208,161,231,248,214,210):rep(451)))
eq("63449cfce29849d882d9552947ebf82920392aea", sha1(string.char(216,12,113,137,33,99,200,140,6,222,170,2,115,50,138,134,211,244,176,250,42,95):rep(721)))
eq("15dc62f4469fb9eae76cd86a84d576905c4bbfe7", sha1(string.char(50,194,13,88,156,226,39,135,165,204):rep(417)))
eq("abbc342bcfdb67944466e7086d284500e25aa103", sha1(string.char(35,39,227,31,206,163,148,163,172,253,98,21,215,43,226,227,130,151,236,177,176,63,30,47,74):rep(960)))
eq("77ae3a7d3948eaa2c60d6bc165ba2812122f0cce", sha1(string.char(166,83,82,49,153,89,58,79,131,163,125,18,43,135,120,17,48,94,136):rep(599)))
eq("d62e1c4395c8657ab1b1c776b924b29a8e009de1", sha1(string.char(196,199,71,80,10,233,9,229,91,72,73,205,75,77,122,243,219,152):rep(964)))
eq("15d98d5279651f4a2566eda6eec573812d050ff7", sha1(string.char(78,70,7,229,21,78,164,158,114,232,100,102,92,18,133,160,56,177,160,49,168,149,13,39,249,214,54,41):rep(618)))
eq("c3d9bc6535736f09fbb018427c994e58bbcb98f6", sha1(string.char(129,208,110,40,135,3):rep(618)))
eq("7dc6b3f309cbe9fa3b2947c2526870a39bf96dc4", sha1(string.char(126,184,110,39,55,177,108,179,214,200,175,118,125,212,19,147,137,133,89,209,89,189,233,164,71,81,156,215,152):rep(908)))
eq("b2d4ca3e787a1e475f6608136e89134ae279be57", sha1(string.char(182,80,145,53,128,194,228,155,53):rep(475)))
eq("fbe6b9c3a7442806c5b9491642c69f8e56fdd576", sha1(string.char(9,208,72,179,222,245,140,143,123,111,236,241,40,36,49,68,61,16,169,124,104,42,136,82,172):rep(189)))
eq("f87d96380201954801004f6b82af1953427dfdcb", sha1(string.char(153,133,37,2,24,150,93,242,223,68,202,54,118,141,76,35,100,137,13):rep(307)))
eq("a953e2d054dd77f75337dd9dfa58ec4d3978cfb4", sha1(string.char(112,215,41,50,221,94):rep(155)))
eq("e5c3047f9abfdd60f0c386b9a820f11d7028bc70", sha1(string.char(247,177,124,213,47,175,139,203,81,21,85):rep(766)))
eq("ee6fe88911a13abfc0006f8809f51b9de7f5920f", sha1(string.char(81,84,151,242,186,133,39,245,175,79,66,170,246,216,0,88,100,190,137,2,146,58):rep(10)))
eq("091db84d93bb68349eecf6bfa9378251ecd85500", sha1(string.char(180,71,122,187):rep(129)))
eq("d8041c7d65201cc5a77056a5c7eb94a524494754", sha1(string.char(188,99,87,126,152,214,159,151,234,223,199,247,213,107,63,59,12,146,175,57,79,200,132,202):rep(81)))
eq("cca1d77faf56f70c82fcb7bc2c0ac9daf553adff", sha1(string.char(199,1,184,22,113,25,95,87,169,114,130,205,125,159,170,99):rep(865)))
eq("c009245d9767d4f56464a7b3d6b8ad62eba5ddeb", sha1(string.char(39,168,16,191,95,82,184,102,242,224,15,108):rep(175)))
eq("8ce115679600324b58dc8745e38d9bea0a9fb4d6", sha1(string.char(164,247,250,142,139,131,158,241,27,36,81,239,26,233,105,64,38,249,151,75,142,17,56,217,125,74,132,213,213):rep(426)))
eq("75f1e55718fd7a3c27792634e70760c6a390d40f", sha1(string.char(32,145,170,90,188,97,251,159,244,153,21,126,2,67,36,110,31,251,66):rep(659)))
eq("615722261d6ec8cef4a4e7698200582958193f26", sha1(string.char(51,24,1,69,81,157,34,185,26,159,231,119):rep(994)))
eq("4f61d2c1b60d342c51bc47641e0993d42e89c0f9", sha1(string.char(175,25,99,122,247,217,204,100,0,35,57,65,150,182,51,79,169,99,9,33,113,113,113):rep(211)))
eq("7d9842e115fc2af17a90a6d85416dbadb663cef3", sha1(string.char(136,42,39,219,103,95,119,125,205,72,174,15,210,213,23,75,120,56,104,31,63,255,253,100,61,55):rep(668)))
eq("3eccab72b375de3ba95a9f0fa715ae13cae82c08", sha1(string.char(190,254,173,227,195,41,49,122,135,57,100):rep(729)))
eq("7dd68f741731211e0442ce7251e56950e0d05f96", sha1(string.char(101,155,117,8,143,40,192,100,162,121,142,191,92):rep(250)))
eq("5e98cdb7f6d7e4e2466f9be23ec20d9177c5ddff", sha1(string.char(84,67,182,136,89):rep(551)))
eq("dba1c76e22e2c391bde336c50319fbff2d66c3bb", sha1(string.char(99,226,185,1,192):rep(702)))
eq("4b160b8bfe24147b01a247bfdc7a5296b6354e38", sha1(string.char(144,141,254,1,166,144,129,232,203,31,192,75,145,12):rep(724)))
eq("27625ad9833144f6b818ef1cf54245dd4897d8aa", sha1(string.char(31,187,82,156,224,133,116,251,180,165,246,8):rep(661)))
eq("0ce5e059d22a7ba5e2af9f0c6551d010b08ba197", sha1(string.char(228):rep(672)))
eq("290982513a7f67a876c043d3c7819facb9082ea6", sha1(string.char(150,44,52,144,68,76,207,114,106,153,99,39,219,81,73,140,71,4,228,220,55,244,210,225,221,32):rep(881)))
eq("14cf924aafceea393a8eb5dd06616c1fe1ccd735", sha1(string.char(140,194,247,253,117,121,184,216,249,84,41,12,199):rep(738)))
eq("91e9cc620573db9a692bb0171c5c11b5946ad5c3", sha1(string.char(48,77,182,152,26,145,231,116,179,95,21,248,120,55,73,66):rep(971)))
eq("3eb85ec3db474d01acafcbc5ec6e942b3a04a382", sha1(string.char(68,211):rep(184)))
eq("f9bd0e886c74d730cb2457c484d30ce6a47f7afa", sha1(string.char(168,73,19,144,110,93,7,216,40,111,212,192,33,9,136,28,210,175,140,47,125,243,206,157,151,252,26):rep(511)))
eq("64461476eb8bba70e322e4b83db2beaee5b495d4", sha1(string.char(33,141):rep(359)))
eq("761e44ffa4df3b4e28ca22020dee1e0018107d21", sha1(string.char(254,172,185,30,245,135,14,5,186,42,47,22):rep(715)))
eq("41161168b99104087bae0f5287b10a15c805596f", sha1(string.char(79):rep(625)))
eq("7088f4d88146e6e7784172c2ad1f59ec39fa7768", sha1(string.char(20,138,80,102,138,182,54,210,38,214,125,123,157,209,215,37):rep(315)))
eq("2e498e938cb3126ac1291cee8c483a91479900c1", sha1(string.char(140,197,97,112,205,97,134,190):rep(552)))
eq("81a2491b727ef2b46fb84e4da2ced84d43587f4e", sha1(string.char(109,44,17,199,17,107,170,54,113,153,212,161,174):rep(136)))
eq("0e4f8a07072968fbc4fe32deccbb95f113b32df7", sha1(string.char(181,247,203,166,34,61,180,48,46,77,98,251,72,210,217,242,135,133,38,12,177,163,249,31,1,162):rep(282)))
eq("8d15dddd48575a1a0330976b57e2104629afe559", sha1(string.char(15,60,105,249,158,45,14,208,202,232,255,181,234,217):rep(769)))
eq("98a9dd7b57418937cbd42f758baac4754d5a4a4b", sha1(string.char(115,121,91,76,175,110,149,190,56,178,191,157,101,220,190,251,62,41,190,37):rep(879)))
eq("578487979de082f69e657d165df5031f1fa84030", sha1(string.char(189,240,198,207,102,142,241,154):rep(684)))
eq("3e6667b40afb6bcc052654dd64a653ad4b4f9689", sha1(string.char(85,82,55,80,43,17,57,20,157,10,148,85,154,58,254,254,221,132,53,105,43,234,251,110,111):rep(712)))
