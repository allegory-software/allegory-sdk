<!DOCTYPE html>
<html hidden>
<head>
<title>X-WIDGETS DEMO</title>
<meta charset="utf-8">
<base href="../../www/">
<link rel="stylesheet" type="text/css" href="fontawesome.css" crossorigin>
<script src="glue.js"></script>
<script src="dom.js"></script>
<script src="css.js"></script>
<script src="mustache.js"></script>
<script src="webb_spa.js"></script>
<script src="purify.js"></script>
<script src="widgets.js"></script>
<script src="nav.js"></script>
<script src="grid.js"></script>
<script src="charts.js"></script>
<script src="module.js"></script>
<script src="markdown-it.js"></script>
<script src="theme-tw.js"></script>
<script src="ace/ace.js"></script>

<style>

#layout {
	height: 100%;
	display: flex;
}

#code_split {
	flex: 1;
	display: flex;
	flex-flow: column;
	border-left: 1px solid #333;
}

#result_split {
	flex: 1;
	display: flex;
	flex-flow: column;
	border-left: 1px solid #333;
	min-width: 0;
	min-height: 0;
	overflow: auto;
}

#buttons, #result_buttons {
	display: flex;
	border-bottom: 1px solid #333;
}

#demo_list { overflow: hidden auto; padding-top: .5em; user-select: none; }
#code      { flex: 1; }
#result    { padding: 1em; overflow: auto; }
#inspect   { flex: 1; border-top: 1px solid #333; }

#code:focus {
	outline: none;
}

.demo-list-item {
	padding: 0.2em .5em;
}

.demo-list-item:hover { background: #ddd; }
.theme-dark .demo-list-item:hover { background: #333; }
.demo-list-item.selected { background: #ddf; }
.theme-dark .demo-list-item.selected { background: #336; }

button[pressed] { background: var(--bg-button-active); }

</style>

</head>

<body>

<div id=layout>
	<div id=demo_list></div>
	<div id=code_split>
		<div id=buttons class="smaller gap-x-05 p-x-05">
			<button id=run_button>Run</button>
			<button id=reload_button>Reload</button>
			<div class="S h-r gap-x-05">
				<button class="theme-btn" key=light >Light</button>
				<button class="theme-btn" key=dark  >Dark</button>
				<d class="m b-l"></d>
				<button class="size-btn" key=small  >Small</button>
				<button class="size-btn" key=normal >Normal</button>
				<button class="size-btn" key=large  >Large</button>
			</div>
		</div>
		<aceeditor id=code></aceeditor>
	</div>
	<div id=result_split>
		<div id=result_buttons class="smaller p-x-05 gap-x-05 h-r">
			<button class="layout-btn" key=inline   layout-classes="display-inline ">Inline</button>
			<button class="layout-btn" key=flex-h-t layout-classes="h-t S shrinks  ">Flex H-T</button>
			<button class="layout-btn" key=flex-h-s layout-classes="h-s S shrinks  ">Flex H-S</button>
			<button class="layout-btn" key=flex-v-s layout-classes="v-s S shrinks  ">Flex V-S</button>
			<button class="layout-btn" key=flex-v-l layout-classes="v-l S shrinks  ">Flex V-L</button>
			<button class="layout-btn" key=grid     layout-classes="grid shrinks   ">Grid</button>
		</div>
		<div id=result></div>
		<div id=inspect></div>
	</div>
</div>
<script>

css('.display-inline', '', ` display: inline; `)

on_dom_load(function() {

	init_xmodule()
	init_components()

	// ace.config.set('basePath', '/ace')

	let ace_editor = ace.edit(code, {
		mode: 'ace/mode/javascript',
		highlightActiveLine: false,
		showGutter: false,
		printMargin: false,
		displayIndentGuides: false,
		tabSize: 3,
	})

	// disable Tab in the editor since we need to demo tab navigation.
	ace_editor.commands.removeCommand(ace_editor.commands.byName.indent)
	ace_editor.commands.removeCommand(ace_editor.commands.byName.outdent)

	function get_script() {
		return ace_editor.getSession().getValue()
	}

	function set_script(s) {
		ace_editor.getSession().setValue(s)
	}

	function run_script() {
		result.unsafe_html = get_script()
		inspect.clear()
		// inspect.
	}

	run_button.on('click', function() {
		run_script()
	})

	reload_button.on('click', function() {
		save('script', get_script())
		window.location = window.location
	})

	{
	let i = 0
	$('xmp,script[type="text/x-mustache"]').each(function(e) {
		if (!e.id.ends('_demo'))
			return
		let name = e.id.replace('_demo', '')
		let s = window[name+'_demo'].html.trim()
		let item = div({class: 'demo-list-item'}, name)
		demo_list.add(item)
		let i1 = i
		item.on('click', function() {

			ace_editor.getSession().setValue(s)
			ace_editor.initial_script = s
			run_script()

			let i0 = load('selected_demo_index')
			let item0 = i0 != null && demo_list.at[i0]
			if (item0)
				item0.class('selected', false)
			item.class('selected', true)
			save('selected_demo_index', i1)

		})
		i++
	})
	}

	function init_select_buttons(btn_class, default_key, action) {
		for (let btn of $(btn_class)) {
			btn.action = function() {
				for (let btn of $(btn_class))
					btn.bool_attr('pressed', null)
				btn.bool_attr('pressed', true)
				let key = btn.attr('key')
				action(btn, key)
				save(btn_class, key)
			}
		}
		let btn = $1(btn_class+'[key='+(load(btn_class) || default_key)+']')
		if (btn)
			btn.action() // btn.click() doesn't work on hidden buttons. smaart.
	}
	init_select_buttons('.layout-btn', 'inline', function(btn) {
		result.attr('class', btn.attr('layout-classes'))
	})
	init_select_buttons('.size-btn', 'normal', function(btn, key) {
		set_theme_size(key)
	})
	init_select_buttons('.theme-btn', 'light', function(btn, key) {
		let dark = key == 'dark'
		set_theme_dark(dark)
		ace_editor.setTheme(dark ? 'ace/theme/tomorrow_night' : null)
	})

	{
	let i = load('selected_demo_index')
	let item = i != null && demo_list.at[i]
	if (item)
		item.click()
	let s = load('script')
	if (s) {
		set_script(s)
		run_script()
		save('script')
	}
	}

	root.show()

})

</script>

<xmp id=intro_demo>
To run this demo without a web server, you need allow JavaScript to see files
loaded with <code>file:///</code> urls:

<ul>
<li><b>Chrome:</b> start it with command-line option <code>--allow-file-access-from-files</code>.</li>
<li><b>Firefox:</b> in <code>about:config</code>, type <code>security.fileuri.strict_origin_policy</code> and set it to false.</li>
</ul>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=component_demo>
<component tag=foo>
	<script>
		let content = [...e.nodes]
		let wrapper = div({class: 'm b p h-c'}, content)
		e.set(wrapper)
	</script>
</component>

<foo>Hello!</foo>

</xmp>

<!--------------------------------------------------------------------------->

<xmp id=render_demo>
<render>
	<template>
		<div class="v">
			{{#people}}
			<div class="m b p v">
				<div class="bold">{{name}}</div>
				<div class="smaller">{{phone}}</div>
			</div>
			{{/people}}
		</div>
	</template>
	<script>
		return {
			people: [
				{name: 'John Doe', phone: '+123 456 789'},
				{name: 'Jane Doe', phone: '+321 456 789'},
			],
		}
	</script>
</render>

</xmp>

<!--------------------------------------------------------------------------->

<xmp id=if_demo>
<if global=foo>
	foo was set!
</if>
<script run>
	let timer_id = runagainevery(.5, function() {
		setglobal('foo', !(window.foo))
	})
	this.on_bind(function(on) {
		if (!on)
			clearInterval(timer_id)
	})
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=tooltip_demo>
<script run>

b1 = button({text: html('aaa ^ aaa<br>aaa aaa aaa v aaa aaa aaa')})
b2 = button({text: html('aaa ^ aaa<br>aaa aaa aaa v aaa aaa aaa')})
b3 = button({text: html('aaa ^ aaa<br>aaa aaa aaa v aaa aaa aaa')})
result.add(div({style: 'text-align: center'}, div({}, b1), div({}, b2), div({}, b3)))

b1.style['margin'] = '5em'
b2.style['margin'] = '5em'

let s1 = 'aaa v aaa'
let s2 = 'aaa v aaa<br>aaa aaa v aaa aaa'
let s3 = 'aaa v aaa<br>aaa aaa v aaa aaa<br>aaa aaa aaa v aaa aaa aaa'

b1.add(tooltip({text: html(s1), side: 'right' , align: 'center', kind: 'info', close_button: true , icon_visible: true, target: b1.focus_box}))
b1.add(tooltip({text: html(s2), side: 'top'   , align: 'center', kind: 'info', close_button: true , icon_visible: true, target: b1.focus_box}))
b1.add(tooltip({text: html(s3), side: 'bottom', align: 'center', kind: 'info', close_button: true , icon_visible: true, target: b1.focus_box}))
b1.add(tooltip({text: html(s3), side: 'left'  , align: 'center', kind: 'info', close_button: false, icon_visible: true, target: b1.focus_box}))

b2.add(tooltip({text: html(s1), side: 'right' , align: 'start', close_button: true , icon_visible: true, target: b2.focus_box}))
b2.add(tooltip({text: html(s2), side: 'top'   , align: 'start', close_button: false, icon_visible: true, target: b2.focus_box}))
b2.add(tooltip({text: html(s3), side: 'bottom', align: 'start', close_button: true , icon_visible: true, target: b2.focus_box}))
b2.add(tooltip({text: html(s3), side: 'left'  , align: 'start', close_button: false, icon_visible: true, target: b2.focus_box}))

b3.add(tooltip({text: html(s1), side: 'right' , align: 'end', kind: 'error', close_button: true , icon_visible: true, target: b3.focus_box}))
b3.add(tooltip({text: html(s2), side: 'bottom', align: 'end', kind: 'error', close_button: false, icon_visible: true, target: b3.focus_box}))
b3.add(tooltip({text: html(s3), side: 'bottom', align: 'end', kind: 'error', close_button: true , icon_visible: true, target: b3.focus_box}))
b3.add(tooltip({text: html(s3), side: 'left'  , align: 'end', kind: 'error', close_button: false, icon_visible: true, target: b3.focus_box}))
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=toaster_demo>
<script run>

t = toaster()
result.add(t)

t.post('Hello there', null, 1)
t.post('I\'ve got something to tell you...', 'info', 2)
t.post('Pay attention!', 'error', 3)

</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=notify_demo>
<script run>

notify('Did you see that?', 'info')
notify('Where?')
notify('There!', 'error', 2)

</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=menu_demo>
<div id=main></div>
<script run>

function action(item) { pr(item.text) }

m = menu({
	popup_side: 'bottom',
	popup_align: 'left',
	popup_y1: 2,
	items: [
		{text: 'Open', action: action, key: 'Ctrl+B', icon: 'fa fa-folder-open'},
		{text: 'Close', disabled: true, icon: 'fa fa-window-close', action: action, separator: true},
		{text: 'More', items: [
			{text: 'Check', checked: true},
			{text: 'Check No Close', checked: true,
				action: function(a) { pr(a.checked); return false } },
			{text: 'More Stuff', items: [
				{text: 'More Stuff 1 this is a very long item text'},
				{text: 'More Stuff 2', action: action},
			]},
		]},
		{text: 'Even More', items: [
			{text: 'Even More Stuff 1'},
			{text: 'Even More Stuff 2'},
		]},
	],
})

b = button({
	text: 'Click for menu',
	primary: true,
	action: function() {
		main.add(m)
	},
})

main.add(b)

</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=tabs_demo>
<tabs id=test_tabs selected_tab=second_page tabs_side=top style="min-height: 200px">
	<div id=test_tabs_page_1 label="First Page" id=first_page>
		<h1>This is the first page</h1>
		<p>You can put anything in here.</p>
	</div>
	<div id=test_tabs_page_2 label="Second Page" id=second_page>
		<h1>This is the second page.</h1>
		<p>You can put anything in here too.</p>
	</div>
</tabs>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=split_demo>
<split>
	<vsplit id=my_split fixed_side=first min_size=100>
		<div style="background: gray">Stuff 1</div>
		<div>Stuff 2</div>
	</vsplit>
	<vsplit fixed_side=second>
		<div>Stuff 3</div>
		<div>Stuff 4</div>
	</vsplit>
</split>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=dialog_demo>
<div id=main></div>
<script run>

win = dlg({
	w: 600,
	heading: 'I\'m playing the title',
	content: div({}, 'I\'m just here for the demo.', tag('br'), 'What do you think?'),
	buttons_layout: 'some-button < yes no > apply:ok cancel',
	buttons: {
		yes: { icon: 'fa fa-thumbs-up' },
		no: { icon: 'fa fa-thumbs-down' },
		apply: { action: function() { win.close(); }, },
	},
})

main.add(button({
	text: 'Click for modal',
	action: function() {
		win.cancelable = true
		win.modal()
	}
}))

main.add(button({
	text: 'Modal that you can\'t close',
	action: function() {
		win.cancelable = false
		win.modal()
	}
}))

</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=toolbox_demo>
<div id=main></div>
<script run>

tb = toolbox({
	id: 'my_toolbox',
	text: 'Imma toolbox',
	content: div({}, 'I\'m just here for the demo.'),
	px: 100,
	py: 100,
	pw: 150,
	ph: 300,
})

main.add(tb)

main.add(button({
	text: 'Click to show toolbox',
	action: function() {
		tb.show().focus()
	}
}))

main.add(button({
	text: 'Click to show another toolbox',
	action: function() {
		main.add(toolbox({
			text: 'Toolbox #'+main.len,
			content: tag('input'),
			pw: 250,
			ph: 200,
		}))
	}
}))

</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=slides_demo>
<slides id=my_slides current=slide2>
	<div id=slide1>
		<h1>Slide 1</h1>
		<p>Lorem ipsum</p>
	</div>
	<div id=slide2>
		<h1>Slide 2</h1>
		<p>Lorem ipsum</p>
		<p>Lorem ipsum</p>
	</div>
</slides>
<div>
	<button onclick="my_slides.prev_slide()">prev slide</button>
	<button onclick="my_slides.next_slide()">next slide</button>
</div>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=md_demo>
<md>
# Sup fellow kids?

This is a paragraph.

And this is a [link](exmaple.com).
</md>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=pagenav_demo>
<pagenav on_page_changed=page_changed></pagenav>
<pagenav item_count=5 page_size=1 bare on_page_changed=page_changed></pagenav>
<pagenav item_count=10000 page=50 on_page_changed=page_changed></pagenav>
<script run>
page_changed = function(page) {
	this.page = page
}
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=richtext_demo>
<richtext id=my_r>
	<b>Wasup</b> <i>homies</i> ?
</richtext>
<script run>
my_r.widget_editing = true
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=info_demo>
<info id=my_info>
	<h3>It never entered my mind, but</h3>
	<p>Here we are</p>
</info>
<button action=toggle_collapsed>Toggle Collapsed</button>
<script run>
toggle_collapsed = function() {
	my_info.collapsed = !my_info.collapsed
}
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=check_demo>
<d class="h-m m b ro p">
	<check id=my_check checked></check><label for=my_check>Wasup</label>
</d>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=toggle_demo>
<d class="h-m m b p ro">
	<label for=my_toggle class="S p-x">Wasup</label><toggle id=my_toggle checked></toggle>
</d>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=radio_demo>
<radio-group class="v-m m b p ro">
	<d class="h-m"><radio id=my_radio1 checked></radio><label for=my_radio1>Option 1</label></d>
	<d class="h-m"><radio id=my_radio2></radio><label for=my_radio2>Option 2</label></d>
</radio-group>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=slider_demo>
<slider val=0.7 marked=false></slider>
<slider val=5 from=1 to=9 min=3 max=7 decimals=0></slider>
<range-slider min_val=1200 max_val=1800 from=1000 to=2000 decimals=0></range-slider>
<script run>
//s1.add_validator('custom', field => ({
//		validate: v => isnum(v) && v >= .2 && v <= .8,
//		message: 'Value not between .2 and .8',
//	})
//)
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=input_demo>
<d class="grid-h grid-2col grid-m" style="grid-template-columns: 1fr 6fr">
xsmall  <span class="ro-group-h b-collapse-h xsmall  "><input class="ro-var" value="Oh My!"><button>OK</button></span>
small   <span class="ro-group-h b-collapse-h small   "><input class="ro-var" value="Oh My!"><button>OK</button></span>
smaller <span class="ro-group-h b-collapse-h smaller "><input class="ro-var" value="Oh My!"><button>OK</button></span>
normal  <span class="ro-group-h b-collapse-h normal  "><input class="ro-var" value="Oh My!"><button>OK</button></span>
large   <span class="ro-group-h b-collapse-h large   "><input class="ro-var" value="Oh My!"><button>OK</button></span>
xlarge  <span class="ro-group-h b-collapse-h xlarge  "><input class="ro-var" value="Oh My!"><button>OK</button></span>
</d>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=input-group_demo>

<d class="S h ro-group-h b-collapse-h">
	<input-group class="ro-var">
		<d class="ro-var h-m p-x fa fa-car"></d>
		<labelbox class="ro-var">
			<label>On my label</label>
			<input-group>
				<button bare icon="fa fa-bicycle"></button>
				<input value="Oh My!">
				<d class="ro-var h-m p-x fa fa-bicycle"></d>
			</input-group>
		</labelbox>
		<button>...</button>
		<d class="ro-var h-m p-x fa fa-truck"></d>
		<button><d class="icon-9-dots"></d></button>
	</input-group><button>OK</button>
</d>

</xmp>

<!--------------------------------------------------------------------------->

<xmp id=teaxtarea_demo>
<textarea></textarea>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=button_demo>
<p>
	<button id=cancel_button confirm="U sure?" class=large>Cancel</button>, says the button.
	<button id=danger_button danger>Don't do it Jonny!</button>, says another.
	<button icon="fa fa-recycle" bare></button>
</p>
<p>
	<button primary>OK</button>
	<button icon="fa fa-folder">Click&nbsp;<i>me</i>&nbsp;too!</button>
	<button icon="mi mi-folder">Using mi icons</button>
	<button bare icon="fa fa-play">I'm also a button</button>
	<script run>
		this.parent.add(button({
			text: html('Multiline text<br>works too!'),
			icon: 'fa fa-folder-open',
			action: function() { this.debug('clicked') },
		}))

		danger_button.action = function() {
			cancel_button.click()
		}
		cancel_button_action = function() {
			this.debug('clicked')
		}
	</script>
</p>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=select-button_demo>
<d class="small">
	<select-button>
		<d><span class="mi">rocket</span>Rockets</d>
		<d><span class="mi">radar</span>Radar</d>
		<d><span class="mi">military_tech</span>Stars</d>
	</select-button>
	<button>OK</button>
	<input class="w4 ro-var">
	<select-button>
		<d class="mi">dark_mode</d>
		<d class="mi">light_mode</d>
	</select-button>
	<select-button>
		<d style="font-size: .75em">A</d>
		<d style="">A</d>
		<d style="font-size: 1.25em">A</d>
	</select-button>
</d>
<d class=large>
	<select-button>
		<d><span class="mi">rocket</span> Rockets</d>
		<d><span class="mi">radar</span> Radar</d>
		<d><span class="mi">military_tech</span> Stars</d>
	</select-button>
	<button>OK</button>
	<input class="w4 ro-var">
	<select-button>
		<d class="mi">dark_mode</d>
		<d class="mi">light_mode</d>
	</select-button>
	<select-button>
		<d style="font-size: .75em">A</d>
		<d style="">A</d>
		<d style="font-size: 1.25em">A</d>
	</select-button>
</d>
<select-button>
	<d>Label</d>
	<d>Label</d>
	<d>Label</d>
</select-button>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=tags_demo>
<tags-box tags="Apples Bananas Mangos what do you do when there are too many tags"></tags-box>

<tags nowrap tags="Apples Bananas Mangos"></tags>

<tags nowrap tags="Apples Bananas Mangos what do you do when there are too many tags"></tags>

<d class="ro-group-h h-m flex-nowrap shrinks xsmall "><tags class="S" tags="apples bananas mangos"></tags><button>OK</button></d>
<d class="ro-group-h h-m flex-nowrap shrinks small  "><tags class="S" tags="apples bananas mangos"></tags><button>OK</button></d>
<d class="ro-group-h h-m flex-nowrap shrinks smaller"><tags class="S" tags="apples bananas mangos"></tags><button>OK</button></d>
<d class="ro-group-h h-m flex-nowrap shrinks normal "><tags class="S" tags="Apples Bananas Mangos what do you do when there are too many tags"></tags><button>OK</button></d>
<d class="ro-group-h h-m flex-nowrap shrinks normal "><tags class="S" nowrap tags="what do you do when there are too many tags"></tags><button>OK</button></d>
<d class="ro-group-h h-m flex-nowrap shrinks large  "><tags class="S" tags="apples bananas mangos"></tags><button>OK</button></d>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=autocomplete_demo>
<input id=my_input>
<autocomplete id=my_auto for=my_input>
	<div text="">Option 1</div>
</autocomplete>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id="list-drag_demo">
<script type="text/x-mustache" id=list_drag_demo_template>
	<div class="b2 p bg1 noselect" style="{{#height}}height: {{height}}{{/height}}">
		<div class="bold nowrap">{{name}}</div>
		{{#phone}}<div class="smaller nowrap">{{phone}}</div>{{/phone}}
		{{#email}}<div class="smaller nowrap">{{email}}</div>{{/email}}
	</div>
</script>
<list class="m b p gap" style="border-width: 10px" item_template=list_drag_demo>
	<script>
		let i = 0, a = []
		while (++i <= 200)
			a.push({name: 'John Doe 1.'+i, phone: '+123 456 '+i})
		return a
	</script>
</list>
<list class="m b p-4 gap-4" style="border-width: 10px;" item_template=list_drag_demo>
	<script>
		return [
			{name: 'John Doe 2.1', phone: '+123 456 789', },
			{name: 'John Doe 2.2', phone: '+321 456 789', email: 'bla@bla.com'},
			{name: 'John Doe 2.3', phone: '+213 456 789', email: 'bla@bla.com'},
		]
	</script>
</list>
<list class="S self-h-t m b gap h-l" item_template=list_drag_demo items='[
	{"name": "John Doe 3.1", "phone": "+123 456 789"},
	{"name": "John Doe 3.2", "phone": "+321 456 789", "email": "bla@bla.com"},
	{"name": "John Doe 3.3", "phone": "+213 456 789", "email": "bla@bla.com"}
]'></list>
<script run>
for (let e of $('list')) {
	e.make_focusable()
	e.make_list_items_focusable()
	e.make_list_drag_elements()
	e.make_list_drop_elements()
}
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=dropdown_demo>
<dropdown value="55" align=right>
	<list>
		<script type="text/x-mustache"><div searchable>{{name}}</div></script>
		<script>
			let a = []
			for (let i = 1; i <= 100; i++)
				a.push({value: i+'', name: 'Option '+i})
			return a
		</script>
	</list>
</dropdown>
<button>OK</button>
<input><button>OK</button>

<dropdown value=grass>
	<b value=chickens ><span class="fas fa-drumstick-bite"></span> <span searchable>Chickens </span></b>
	<u value=cows style="--fa-display: inline"><span class="fas fa-hat-cowboy"></span> <span searchable>Cows</span></u>
	<i value=grass><i><span searchable>Grass</span></i>
</dropdown>

<dropdown>
	<list>
		<script type="text/x-mustache">
			{{#cat}}
				<div class="noselect v-m bold large label">{{cat}}</div>
			{{/cat}}
			{{#choose}}
				<div class="noselect v-m bold" style="min-height: 5em">Choose...</div>
			{{/choose}}
			{{^cat}}{{^choose}}
				<div class="noselect v-m" style="min-height: 5em">
					<div class="bold nowrap" searchable>{{name}}</div>
					{{#phone}}<div class="smaller nowrap" searchable>{{phone}}</div>{{/phone}}
					{{#email}}<div class="smaller nowrap" searchable>{{email}}</div>{{/email}}
				</div>
			{{/choose}}{{/cat}}
		</script>
		<script>
			return [
				{value: null, choose: 'Choose'},
				{cat: "Foos'n'Bars", focusable: false},
				{value: 'x', name: 'X Foo', phone: '+38 321 654', email: 'x.foo@example.com'},
				{value: 'y', name: 'Y Bar', phone: '+40 123 456', email: 'y.bar@example.com'},
				{cat: "Baz's", focusable: false},
				{value: 'z', name: 'Z Baz', phone: '+36 456 123', email: 'z.baz@example.com'},
			]
		</script>
	</list>
</dropdown>

<script run>
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id="input align_demo">
<d class="grid-h grid-m grid-2col gap-x" style="grid-template-columns: 5em auto">
	<check  class="self-h-c" id=check1></check><label for=check1>Check me baby</label>
	<radio  class="self-h-c" id=radio1 group=g1></radio><label for=radio1>Pick me</label>
	<radio  class="self-h-c" id=radio2 group=g1 checked></radio><label for=radio2>No, pick me!</label>
	<toggle class="self-h-c" id=toggle1></toggle><label for=toggle1>Toggle me</label>
	<d></d><label for=input1>Some input</label>
	<d></d><input id=input1></input>
</d>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=calendar_demo>
<ranges-calendar class="large" ranges="1/1/2022..1/5/2022 1/13/2022..1/15/2022"></ranges-calendar>
<range-calendar day1="1/1/2022" day2="1/5/2022"></range-calendar>
<calendar class="smaller" day="1/1/2022"></calendar>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=date_input_demo>
<date-input day="1/18/2022"></date-input>
<date-range-input day1="1/18/2022" day2="2/3/2022"></date-range-input>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=grid_demo>
<div id=main style="height: 100%; display: flex;"></div>
<script run>

let checked = () => html('<div class="fa fa-check"></div>')

function starts_with_a(s) {
	return s.lower().starts('a') || 'Name must start with "A"'
}

let fields = [
	{name: 'id'        , w:  50, min_w:  30, type: 'number', editable: false},
	{name: 'index'     , w:  50, type: 'number', editable: false},
	{name: 'active'    , w:  30, type: 'bool', true_text: checked, false_text: ''},
	{name: 'name'      , w: 150, min_w:  50, max_w: 400, validate: starts_with_a, filter_by: true},
	{name: 'parent_id' , w:  50, min_w:  50, type: 'number', allow_null: true, editable: false, focusable: false},
	{name: 'random_num', w: 130, allow_null: true, type: 'number',
		label: 'Random Number',
		info: 'Just a random number\ngenerated here on the client'},
	{name: 'date'      , w: 120, allow_null: true, type: 'time', filter_by: true},
]

let rows = []

for (let i = 0; i <= 10000; i++) {
	let id         = i
	let name       = 'record '+i
	let parent_id  = i > 1 ? (i-1) % 3 : null // floor((random() * i))
	let random_num = floor(random() * 1e9)
	let random_date = clamp(i * 24 * 3600 * 10, 0, time(3000, 0))
	let active = i % 5 == 0
	let row = [id, id, active, name, parent_id, random_num, random_date]
	row.focusable = true // i % 100 >= 85
	rows.push(row)
}

g = grid({
	id: 'my_grid',
	rowset: {
		fields: fields,
		rows: rows,
		pk: 'id',
		parent_col: 'parent_id',
		index_col: 'index',
	},
	order_by: 'active name:desc',
	tree_col: 'name',
	//can_edit: false,
	can_change_header_visibility: true,
	//can_focus_cells: false,
	//order_by: 'parent_id name:desc',
	can_move_rows: true,
	//enter_edit_on_click_focused: false,
	//can_change_parent: false,
})

main.add(g)

</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id="html grid_demo">
<grid>
	<col-attrs for=id type=number></col-attrs>
	<rowset pk=id can_change_rows=false>
		<field name=id   ></field>
		<field name=name ></field>
		<field name=desc ></field>
		<row id=1 name=Foo desc="Le Foo"></row>
		<row id=2 name=Bar desc="Le Bar"></row>
		<row id=3 name=Baz desc="Le Baz"></row>
	</rowset>
</grid>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=charts_demo>
<vsplit>
	<tabs>
		<script run label=Grid>
			let g = grid({
				id: 'g',
				_label: 'Grid',
				rowset: {
					fields: [
						{name: 'date', type: 'time', has_time: false, w: 60},
						{name: 'country', w: 60},
						{name: 'sector', w: 70},
						{name: 'output', type: 'number', w: 40},
					],
					rows: [
						[year(time(), 0), 'Algeria', 'Energy'        ,  80],
						[year(time(), 1), 'Algeria', 'Chickens'      , 100],
						[year(time(), 2), 'Algeria', 'Chickens'      , 150],
						[year(time(), 0), 'Canada' , 'Chickens'      ,  20],
						[year(time(), 1), 'Canada' , 'Geese'         ,  10],
						[year(time(), 1), 'Canada' , 'Geese'         , 120],
						[year(time(), 2), 'Canada' , 'Geese'         ,  50],
						[year(time(), 0), 'Croatia', 'Science'       , 100],
						[year(time(), 0), 'Croatia', 'Chickens'      , 200],
						[year(time(), 1), 'Croatia', 'Energy'        , 150],
						[year(time(), 1), 'Croatia', 'Energy'        , 120],
						[year(time(), 2), 'Croatia', 'Chickens'      , 180],
						[year(time(), 2), 'Croatia', 'Energy'        ,  50],
					],
				},
			})
			this.parent.on_bind(function(on) {
				if (on) {
					this.items = [g]
				}
			})
		</script>
		<div label=Empty id=empty_div>This is empty to disconnect the grid.</div>
	</tabs>
	<split fixed_side=second>
		<tabs tabs_side=left>
			<chart label=Pie nav=g
				sum_cols=output
				group_cols="country sector"
			></chart>
			<chart label="Areas" nav=g
				shape=areas
				sum_cols=output
				split_cols=country
				group_cols="date/0/month/1"
			></chart>
			<chart label="Areas+Dots" nav=g
				shape=areas_dots
				sum_cols=output
				split_cols=country
				group_cols="date/0/month/1"
			></chart>
			<chart label="Lines" nav=g
				shape=lines
				sum_cols=output
				split_cols=country
				group_cols="date/0/month/1"
			></chart>
			<chart label="Lines+Dots" nav=g
				shape=lines_dots
				sum_cols=output
				split_cols=country
				group_cols="date/0/month/1"
			></chart>
			<chart label=Columns nav=g
				shape=columns
				sum_cols=output
				split_cols="country sector"
				group_cols="date/0/month/1"
			></chart>
			<chart label=Bars nav=g
				shape=bars
				sum_cols=output
				split_cols="country sector"
				group_cols="date/0/month/1"
			></chart>
			<chart label=Stacks nav=g
				shape=stacks
				sum_cols=output
				split_cols="country sector"
				group_cols="date/0/month/1"
			></chart>
		</tabs>
		<div></div>
	</split>
</vsplit>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=nodes_changed_demo>
<d id=my></d>
<script run>
	my.on('nodes_changed', function() {
		pr('NODES CHANGED')
	})
	runafter(0, function() {
		my.add(div())
		my.add(div())
	})
</script>
</xmp>

<!--------------------------------------------------------------------------->

</body>
</html>
