<!DOCTYPE html>
<html hidden>
<head>
<title>X-WIDGETS DEMO</title>
<meta charset="utf-8">
<base href="../../www/">
<link rel="preload" href="fa-regular-400.woff2" as="font" type="font/woff2">
<link rel="preload" href="fa-solid-900.woff2"   as="font" type="font/woff2">
<style src="fontawesome.css"></style>
<script>
DEBUG_EVENTS = true
DEBUG_ELEMENT_BIND = true
DEBUG_UPDATE = false
</script>
<script src="glue.js"></script>
<script src="dom.js"></script>
<script src="css.js"></script>
<script src="mustache.js"></script>
<script src="webb_spa.js"></script>
<script src="purify.js"></script>
<script src="widgets.js"></script>
<script src="nav.js"></script>
<script src="nav-widgets.js"></script>
<script src="grid.js"></script>
<script src="charts.js"></script>
<script src="xmodule.js"></script>
<script src="markdown-it.js"></script>
<script src="ace/ace.js"></script>

<style>
/*
On Chrome on a Windows with 125% scaling, 80% zoom gets us 1:1 real zoom
so can test in ideal conditions. With a 1440p screen there's even room for
the browser's inspector/debugger.
*/
@media (resolution: 120dpi) {
	:root {
		/* unfortunately this screws up mouse hit-testing so we disable it for now. */
		/* zoom: 80%; */
	}
}
</style>

</head>

<body>

<script>

css('#layout', 'h', `height: 100%; width: 100%;`)
css('#code_split', 'S v b-l')
css('#result_split', 'S v b-l shrinks scroll-auto')
css('#buttons, #result_buttons', 'h b-b')
css('#demo_list', 'clip-x-auto-y p-t noselect')
css('#code', 'S')
css('#result', 'm-4 scroll-auto resize-x', `flex: 3;`)
css('#inspect', 'b-t', `flex: 1;`)
css_state('#code:focus', 'no-outline')
css('.demo-list-item', '', `padding: 0.1em .5em;`)
css_state('button[pressed]', '', `background: var(--bg-button-active);`)

</script>

<div id=layout>
	<div id=demo_list class="focusable-items"></div>
	<div id=code_split>
		<div id=buttons class="smaller gap-x-05 p-x-05">
			<button id=run_button>Run</button>
			<button id=reload_button>Reload</button>
			<div class="S h-r gap-x-05">
				<button class="theme-btn" key=light >Light</button>
				<button class="theme-btn" key=dark  >Dark</button>
				<d class="m b-l"></d>
				<button class="size-btn" key=small  >Small</button>
				<button class="size-btn" key=normal >Normal</button>
				<button class="size-btn" key=large  >Large</button>
			</div>
		</div>
		<aceeditor id=code></aceeditor>
	</div>
	<div id=result_split>
		<div id=result_buttons class="smaller p-x-05 gap-x-05 h-r">
			<button class="layout-btn" key=frame    layout-classes="frame h-s shrinks">H-S + Frame</button>
			<button class="layout-btn" key=inline   layout-classes="inline">Inline</button>
			<button class="layout-btn" key=block    layout-classes="block ">Block</button>
			<button class="layout-btn" key=flex-h-t layout-classes="h-t shrinks  ">Flex H-T</button>
			<button class="layout-btn" key=flex-h-s layout-classes="h-s shrinks  ">Flex H-S</button>
			<button class="layout-btn" key=flex-v-s layout-classes="v-s shrinks  ">Flex V-S</button>
			<button class="layout-btn" key=flex-v-l layout-classes="v-l shrinks  ">Flex V-L</button>
			<button class="layout-btn" key=grid     layout-classes="grid shrinks ">Grid</button>
		</div>
		<div id=result></div>
		<div id=inspect></div>
	</div>
</div>
<script>

let hash = obj()
function order_keys(t) {
	return keys(t).sort().uniq_sorted().reduce((t1, k) => { t1[k] = t[k]; return t1}, obj())
}
for (let kv of window.location.hash.replace(/^#/, '').split(',')) {
	if (!kv) continue
	let [k, v] = kv.split('=')
	hash[k] = v
}
hash = order_keys(hash)
function hash_save(k, v) {
	if (!v) delete hash[k]; else hash[k] = v
	hash = order_keys(hash)
	let a = []; for (let k in hash) a.push(k+'='+hash[k])
	window.location.hash = a.join(',')
}
function hash_load(k) {
	return hash[k]
}

on_dom_load(function() {

	init_xmodule()
	init_components()

	// ace.config.set('basePath', '/ace')

	let ace_editor = ace.edit(code, {
		mode: 'ace/mode/javascript',
		highlightActiveLine: false,
		showGutter: false,
		printMargin: false,
		displayIndentGuides: false,
		tabSize: 3,
	})

	// disable Tab in the editor since we need to demo tab navigation.
	ace_editor.commands.removeCommand(ace_editor.commands.byName.indent)
	ace_editor.commands.removeCommand(ace_editor.commands.byName.outdent)

	function get_script() {
		return ace_editor.getSession().getValue()
	}

	function set_script(s) {
		ace_editor.getSession().setValue(s)
	}

	function run_script() {
		result.unsafe_html = get_script()
		inspect.clear()
		// inspect.
	}

	run_button.on('click', function() {
		run_script()
	})

	reload_button.on('click', function() {
		hash_save('script', get_script())
		window.location = window.location
	})

	{
	let i = 0
	$('xmp,script[type="text/x-mustache"]').each(function(e) {
		if (!e.id.ends('_demo'))
			return
		let name = e.id.replace('_demo', '')
		let s = window[name+'_demo'].html.trim()
		let item = div({searchable: '', class: 'demo-list-item'}, name.replaceAll('_', ' '))
		demo_list.add(item)
		let i1 = i
		item.click = function() {
			ace_editor.getSession().setValue(s)
			ace_editor.initial_script = s
			run_script()

			let i0 = hash_load('selected_demo_index')
			let item0 = i0 != null && demo_list.at[i0]
			if (item0)
				item0.class('selected', false)
			item.class('selected', true)
			hash_save('selected_demo_index', i1)
		}
		i++
	})
	demo_list.make_list_items_focusable()
	demo_list.make_focusable()
	demo_list.make_list_items_searchable()
	listen('focused_item_changed', function(e) {
		if (e != demo_list) return
		demo_list.focused_item.click()
	})
	}

	function init_select_buttons(btn_class, default_key, action) {
		for (let btn of $(btn_class)) {
			btn.action = function() {
				for (let btn of $(btn_class))
					btn.bool_attr('pressed', null)
				btn.bool_attr('pressed', true)
				let key = btn.attr('key')
				action(btn, key)
				hash_save(btn_class, key)
			}
		}
		let btn = $1(btn_class+'[key='+(hash_load(btn_class) || default_key)+']')
		if (btn)
			btn.action() // btn.click() doesn't work on hidden buttons. smaart.
	}
	init_select_buttons('.layout-btn', 'inline', function(btn) {
		result.attr('class', btn.attr('layout-classes'))
		announce('layout_changed')
	})
	init_select_buttons('.size-btn', 'normal', function(btn, key) {
		set_theme_size(key)
	})
	init_select_buttons('.theme-btn', 'light', function(btn, key) {
		let dark = key == 'dark'
		set_theme_dark(dark)
		ace_editor.setTheme(dark ? 'ace/theme/tomorrow_night' : null)
	})

	{
	let i = hash_load('selected_demo_index')
	demo_list.focus_item(i)
	let s = hash_load('script')
	if (s) {
		set_script(s)
		run_script()
		hash_save('script')
	}
	}

	root.show()

})

</script>

<!--------------------------------------------------------------------------->

<xmp id=intro_demo>
To run this demo without a web server, you need allow JavaScript to see files
loaded with <code>file:///</code> urls:

<ul>
<li><b>Chrome & Edge:</b> start it with command-line option <code>--allow-file-access-from-files</code>.</li>
<li><b>Firefox:</b> in <code>about:config</code>, type <code>security.fileuri.strict_origin_policy</code> and set it to false.</li>
<li><b>Safari:</b> Preferences > Advanced > "Show Develop menu in menu bar", then Develop > Disable Cross-Origin Restrictions.</li>
</ul>

This has security implications, do it at your own risk! Or use a server.
Or a second browser that you don't use on the Internet.

</xmp>

<!--------------------------------------------------------------------------->

<xmp id=styling_demo>
<h1>Heading 1</h1>
<h2>Heading 2</h2>
<h3>Heading 3</h3>
<p>
This is <a href="http://example.com/">a link</a>.
</p>
<div class="theme-inverted p">
Embedded inverted theme.
<p>
This is <a href="http://example.com/">a link</a>.
</p>
</div>

</xmp

<!--------------------------------------------------------------------------->

<xmp id=component_demo>
<component tag=foo>
	<script>
		let content = [...e.nodes]
		let wrapper = div({class: 'm b p h-c'}, content)
		e.set(wrapper)
	</script>
</component>

<foo>Hello!</foo>

</xmp>

<!--------------------------------------------------------------------------->

<xmp id=render_demo>
<render>
	<template>
		<div class="v">
			{{#people}}
			<div class="m b p v">
				<div class="bold">{{name}}</div>
				<div class="smaller">{{phone}}</div>
			</div>
			{{/people}}
		</div>
	</template>
	<script>
		return {
			people: [
				{name: 'John Doe', phone: '+123 456 789'},
				{name: 'Jane Doe', phone: '+321 456 789'},
			],
		}
	</script>
</render>

</xmp>

<!--------------------------------------------------------------------------->

<xmp id=if_demo>
<if global=foo>
	foo was set!
</if>
<script run>
	let timer_id = runagainevery(.5, function() {
		setglobal('foo', !(window.foo))
	})
	this.on_bind(function(on) {
		if (!on)
			clearInterval(timer_id)
	})
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=tooltip_demo>
<script run>

b1 = button({text: html('aaa ^ aaa<br>aaa aaa aaa v aaa aaa aaa')})
b2 = button({text: html('aaa ^ aaa<br>aaa aaa aaa v aaa aaa aaa')})
b3 = button({text: html('aaa ^ aaa<br>aaa aaa aaa v aaa aaa aaa')})
result.add(div({style: 'text-align: center'}, div({}, b1), div({}, b2), div({}, b3)))

b1.style['margin'] = '5em'
b2.style['margin'] = '5em'

let s1 = 'aaa v aaa'
let s2 = 'aaa v aaa<br>aaa aaa v aaa aaa'
let s3 = 'aaa v aaa<br>aaa aaa v aaa aaa<br>aaa aaa aaa v aaa aaa aaa'

b1.add(tooltip({text: html(s1), side: 'right' , align: 'center', kind: 'info', close_button: true , icon_visible: true, target: b1.focus_box}))
b1.add(tooltip({text: html(s2), side: 'top'   , align: 'center', kind: 'info', close_button: true , icon_visible: true, target: b1.focus_box}))
b1.add(tooltip({text: html(s3), side: 'bottom', align: 'center', kind: 'info', close_button: true , icon_visible: true, target: b1.focus_box}))
b1.add(tooltip({text: html(s3), side: 'left'  , align: 'center', kind: 'info', close_button: false, icon_visible: true, target: b1.focus_box}))

b2.add(tooltip({text: html(s1), side: 'right' , align: 'start', close_button: true , icon_visible: true, target: b2.focus_box}))
b2.add(tooltip({text: html(s2), side: 'top'   , align: 'start', close_button: false, icon_visible: true, target: b2.focus_box}))
b2.add(tooltip({text: html(s3), side: 'bottom', align: 'start', close_button: true , icon_visible: true, target: b2.focus_box}))
b2.add(tooltip({text: html(s3), side: 'left'  , align: 'start', close_button: false, icon_visible: true, target: b2.focus_box}))

b3.add(tooltip({text: html(s1), side: 'right' , align: 'end', kind: 'error', close_button: true , icon_visible: true, target: b3.focus_box}))
b3.add(tooltip({text: html(s2), side: 'bottom', align: 'end', kind: 'error', close_button: false, icon_visible: true, target: b3.focus_box}))
b3.add(tooltip({text: html(s3), side: 'bottom', align: 'end', kind: 'error', close_button: true , icon_visible: true, target: b3.focus_box}))
b3.add(tooltip({text: html(s3), side: 'left'  , align: 'end', kind: 'error', close_button: false, icon_visible: true, target: b3.focus_box}))
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=toaster_demo>
<script run>

t = toaster()
result.add(t)

t.post('Hello there', null, 1)
t.post('I\'ve got something to tell you...', 'info', 2)
t.post('Pay attention!', 'error', 3)

</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=notify_demo>
<script run>

notify('Did you see that?', 'info')
notify('Where?')
notify('There!', 'error', 2)

</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=menu_demo>
<div id=main></div>
<script run>

function action(item) { pr(item.text) }

m = menu({
	popup_side: 'bottom',
	popup_align: 'left',
	popup_y1: 2,
	items: [
		{text: 'Open', action: action, key: 'Ctrl+B', icon: 'fa fa-folder-open'},
		{text: 'Close', disabled: true, icon: 'fa fa-window-close', action: action, separator: true},
		{text: 'More', items: [
			{text: 'Check', checked: true},
			{text: 'Check No Close', checked: true,
				action: function(a) { pr(a.checked); return false } },
			{text: 'More Stuff', items: [
				{text: 'More Stuff 1 this is a very long item text'},
				{text: 'More Stuff 2', action: action},
			]},
		]},
		{text: 'Even More', items: [
			{text: 'Even More Stuff 1'},
			{text: 'Even More Stuff 2'},
		]},
	],
})

b = button({
	text: 'Click for menu',
	primary: true,
	action: function() {
		main.add(m)
	},
})

// uncomment this to trigger invalid stacking parent warning.
// main.style = 'transform: translateZ(0);'

main.add(b)

</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=tabs_demo>
<d class="h self-h-t">
	<button onclick="mytabs.tabs_side='top';"    >tabs_side=top   </button>
	<button onclick="mytabs.tabs_side='bottom';" >tabs_side=bottom</button>
	<button onclick="mytabs.tabs_side='left';"   >tabs_side=left  </button>
	<button onclick="mytabs.tabs_side='right';"  >tabs_side=right </button>
</d>
<tabs id=mytabs>
	<div tabname="First Tab" class="p-4">
		<h1>This is the first tab</h1>
		<p>You can put anything in here.</p>
		<p>Content is focused on click subject to auto_focus option. <input></input></p>
	</div>
	<div tabname="Second Tab">
		<h1>This is the second tab (no padding).</h1>
		<p>You can put anything in here too.</p>
	</div>
</tabs>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=tabs_editable_demo>
<d class="h self-h-t">
	<button onclick="mytabs.tabs_side='top';"    >tabs_side=top   </button>
	<button onclick="mytabs.tabs_side='bottom';" >tabs_side=bottom</button>
	<button onclick="mytabs.tabs_side='left';"   >tabs_side=left  </button>
	<button onclick="mytabs.tabs_side='right';"  >tabs_side=right </button>
</d>
<tabs
	id=mytabs
	selected_tab=second_page
	tabs_side=top
	can_rename_items
	can_remove_items
	can_add_items
	can_move_items
>
	<div id=mytabs_t1 tabname="First Tab" id=first_tab>
		<h1>This is the first tab</h1>
		<p>You can put anything in here.</p>
		<p>Content is focused on click subject to auto_focus option. <input></input></p>
	</div>
	<div id=mytabs_t2 tabname="Second Tab" id=second_tab>
		<h1>This is the second tab.</h1>
		<p>You can put anything in here too.</p>
	</div>
</tabs>
<script run>
let n = 1
mytabs.create_item = function() {
	return div({tabname: 'New Tab '+n, class: 'p'}, 'Hello! ', input({value: n++}))
}
let items = mytabs.items.slice()
for (let i = 0; i < 4; i++)
	items.push(mytabs.create_item())
mytabs.items = items
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=split_demo>
<split>
	<vsplit id=my_split fixed_side=first min_size=100>
		<div style="background: gray">Stuff 1</div>
		<div>Stuff 2</div>
	</vsplit>
	<vsplit fixed_side=second>
		<div>Stuff 3</div>
		<div>Stuff 4</div>
	</vsplit>
</split>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=dlg_demo>
<div id=main></div>
<script run>

win = dlg({
	w: 600,
	heading: 'I\'m playing the title',
	content: div({}, 'I\'m just here for the demo.', tag('br'), 'What do you think?'),
	buttons_layout: 'some-button < yes no > apply:ok cancel',
	buttons: {
		yes   : { icon: 'fa fa-thumbs-up' },
		no    : { icon: 'fa fa-thumbs-down' },
		apply : { closes: true, action: function() { win.close(); }, },
	},
})

main.add(button({
	text: 'Click for modal',
	action: function() {
		win.cancelable = true
		win.modal()
	}
}))

main.add(button({
	text: 'Modal that you can\'t close',
	action: function() {
		win.cancelable = false
		win.modal()
	}
}))

</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=toolbox_demo>
<div id=main></div>
<script run>

tb = toolbox({
	id: 'my_toolbox',
	text: 'Imma toolbox',
	content: div({}, 'I\'m just here for the demo.'),
	px: 100,
	py: 100,
	pw: 150,
	ph: 300,
})

main.add(tb)

main.add(button({
	text: 'Click to show toolbox',
	action: function() {
		tb.show().focus()
	}
}))

main.add(button({
	text: 'Click to show another toolbox',
	action: function() {
		main.add(toolbox({
			text: 'Toolbox #'+main.len,
			content: tag('input'),
			pw: 250,
			ph: 200,
		}))
	}
}))

</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=slides_demo>
<slides id=my_slides current=slide2>
	<div id=slide1>
		<h1>Slide 1</h1>
		<p>Lorem ipsum</p>
	</div>
	<div id=slide2>
		<h1>Slide 2</h1>
		<p>Lorem ipsum</p>
		<p>Lorem ipsum</p>
	</div>
</slides>
<div>
	<button onclick="my_slides.prev_slide()">prev slide</button>
	<button onclick="my_slides.next_slide()">next slide</button>
</div>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=md_demo>
<md>
# Sup fellow kids?

This is a paragraph.

And this is a [link](exmaple.com).
</md>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=pagenav_demo>
<pagenav on_page_changed=page_changed></pagenav>
<pagenav item_count=5 page_size=1 bare on_page_changed=page_changed></pagenav>
<pagenav item_count=10000 page=50 on_page_changed=page_changed></pagenav>
<script run>
page_changed = function(page) {
	this.page = page
}
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=richtext_demo>
<richtext id=my_r>
	<b>Wasup</b> <i>homies</i> ?
</richtext>
<script run>
my_r.widget_editing = true
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=info_demo>
<info id=my_info>
	<h3>It never entered my mind, but</h3>
	<p>Here we are</p>
</info>
<button action=toggle_collapsed>Toggle Collapsed</button>
<script run>
toggle_collapsed = function() {
	my_info.collapsed = !my_info.collapsed
}
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=checkbox_demo>
<form id=my_form class="ga-m g-2col gap-x">
	<checkbox id=my_check1 name=check1 checked-value=yes checked required></checkbox><label for=my_check1>Check me baby</label>
	<checkbox id=my_check2 name=check2 checked-value=yes value=wrong required></checkbox><label for=my_check2>Check me baby</label>
	<d></d><errors for=my_check2 type=rules></errors>
	<checkbox id=my_check3 name=check3 checked-value=yes unchecked-value=no></checkbox><label for=my_check3>Check me baby</label>
	<d></d><button>Submit</button>
</form>
<script run>
my_form.on('submit', function(ev) {
	for (const [name,value] of new FormData(this))
		pr('', name, ':', value)
	return false
})
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=toggle_demo>
<d class="h-m m b p ro">
	<label for=my_toggle class="S p-x">Wasup</label><toggle id=my_toggle checked></toggle>
</d>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=radio_demo>
<form id=my_form class=skip>
	Group 1:
	<d class="t-m"><radio name=r1 checked-value=v1 id=my_radio1 checked></radio><label for=my_radio1>Option 1</label></d>
	<d class="t-m"><radio name=r1 checked-value=v2 id=my_radio2></radio><label for=my_radio2>Option 2</label></d>
	Group 2:
	<d class="t-m"><radio name=r2 checked-value=v1 id=my_radio3></radio><label for=my_radio3>Option 1</label></d>
	<d class="t-m"><radio name=r2 checked-value=v2 id=my_radio4></radio><label for=my_radio4>Option 2</label></d>
	<button>Submit</button>
</form>
<script run>
my_form.on('submit', function(ev) {
	for (const [name,value] of new FormData(this))
		pr('', name, ':', value)
	return false
})
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=slider_demo>
<script run>
add_validation_rule({
	name     : 's1_slider',
	props    : 'name',
	vprops   : 'input_value',
	requires : 'number',
	applies  : (e) => e.name == 's1',
	validate : (e, v) => v >= .2 && v <= .8,
	error    : () => 'Value not between .2 and .8',
	rule     : () => 'Value must be between .2 and .8',
})
</script>
<form id=my_form class=skip>
	<slider name=s1 value=0.7 marked=false required></slider>
	<slider name=s2 value=5 from=1 to=9 min=3 max=7 decimals=0></slider>
	<range-slider name1=s31 name2=s32
		value1=1800 value2=1200
		from=1000 to=2000
		min=1100 max=1900
		min-range=100 max-range=500
		decimals=0
	></range-slider>
	<button>Submit</button>
</form>
<script run>
my_form.on('submit', function(ev) {
	for (const [name,value] of new FormData(this))
		pr('', name, ':', value)
	return false
})
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=input_demo>
<d class="g-h g-2col g-m" style="grid-template-columns: 1fr 6fr">
xsmall  <span class="ro-collapse-h b-collapse-h xsmall  "><input class="ro-var" value="Oh My!"><button>OK</button></span>
small   <span class="ro-collapse-h b-collapse-h small   "><input class="ro-var" value="Oh My!"><button>OK</button></span>
smaller <span class="ro-collapse-h b-collapse-h smaller "><input class="ro-var" value="Oh My!"><button>OK</button></span>
normal  <span class="ro-collapse-h b-collapse-h normal  "><input class="ro-var" value="Oh My!"><button>OK</button></span>
large   <span class="ro-collapse-h b-collapse-h large   "><input class="ro-var" value="Oh My!"><button>OK</button></span>
xlarge  <span class="ro-collapse-h b-collapse-h xlarge  "><input class="ro-var" value="Oh My!"><button>OK</button></span>
</d>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=input_group_demo>

<input-group class="ro-var">
	<d class="ro-var h-m p-x fa fa-car"></d>
	<labelbox class="ro-var">
		<label>Oh, my label</label>
		<input-group>
			<button bare icon="fa fa-bicycle"></button>
			<input value="Oh My!">
			<d class="ro-var h-m p-x fa fa-bicycle"></d>
		</input-group>
	</labelbox>
	<button>...</button>
	<d class="ro-var h-m p-x fa fa-truck"></d>
	<button><d class="icon-9-dots"></d></button>
</input-group>
<br>
<br>
<input-group>
	<labelbox overlaid>
		<label>Oh, my label</label>
		<input value="Oh My!">
	</labelbox>
</input-group><button>OK</button>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=teaxtarea_demo>
<textarea placeholder="Put some text here"></textarea>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=button_demo>
<p>
	<button id=cancel_button confirm="U sure?" class=large>Cancel</button>, says the button.
	<button id=danger_button danger>Don't do it Jonny!</button>, says another.
	<button icon="fa fa-recycle" bare></button>
</p>
<p>
	<button primary>OK</button>
	<button icon="fa fa-folder">Click&nbsp;<i>me</i>&nbsp;too!</button>
	<button icon="mi mi-folder">Using mi icons</button>
	<button bare primary icon="fa fa-play">I'm also a button</button>
	<script run>
		this.parent.add(button({
			text: html('Multiline text<br>works too!'),
			icon: 'fa fa-folder-open',
			action: function() { this.debug('clicked') },
		}))

		danger_button.action = function() {
			cancel_button.click()
		}
		cancel_button_action = function() {
			this.debug('clicked')
		}
	</script>
</p>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=select_button_demo>
<d class="small">
	<select-button secondary value=v2>
		<d value=v1><span class="mi">rocket</span>Big Rockets</d>
		<d value=v2><span class="mi">radar</span>Radar</d>
		<d value=v3><span class="mi">military_tech</span>Stars</d>
	</select-button>
	<button>OK</button>
	<input class="w4 ro-var">
	<select-button value=light>
		<d value=dark  class="mi">dark_mode</d>
		<d value=light class="mi">light_mode</d>
	</select-button>
	<select-button>
		<d value=1 style="font-size: .75em">A</d>
		<d value=2 style="">A</d>
		<d value=3 style="font-size: 1.25em">A</d>
	</select-button>
</d>
<d class=large>
	<select-button name=sb1 value=v5>
		<d value=v1><span class="mi">rocket</span> Big Rockets</d>
		<d value=v2><span class="mi">radar</span> Radar</d>
		<d value=v3><span class="mi">military_tech</span> Stars</d>
	</select-button>
	<button>OK</button>
	<input class="w4 ro-var">
	<select-button value=dark>
		<d value=dark  class="mi">dark_mode</d>
		<d value=light class="mi">light_mode</d>
	</select-button>
	<select-button value=2>
		<d value=1 style="font-size: .75em">A</d>
		<d value=2 style="">A</d>
		<d value=3 style="font-size: 1.25em">A</d>
	</select-button>
</d>
<select-button>
	<d value=1>Label</d>
	<d value=1>Label</d>
	<d value=1>Label</d>
</select-button>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=textarea_input_demo>
<textarea-input id=my_ta1 class=small value="abc" required max-len=4></textarea-input>
<div>
	<textarea-input required placeholder="Put stuff here" id=my_ta2></textarea-input>
	<errors for=my_ta2></errors>
	<button>Submit</button>
</div>
</form>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=text_input_demo>
<div class="xsmall  "><text-input value="abc"></text-input><button>OK</button></div>
<div class="small   "><text-input value="abc"></text-input><button>OK</button></div>
<div class="smaller "><text-input></text-input><button>OK</button></div>
<div class="normal  "><text-input required max-len=3 placeholder="Put stuff here" id=my_input></text-input><button>OK</button></div>
<errors for=my_input></errors>
<div class="large   "><text-input value="abc" required id=my_input2></text-input><button>OK</button></div>
<errors for=my_input2 type=rules></errors>
<script run>
my_input2.validator.add_rule({
	vprops   : 'input_value',
	validate : (e, v) => v == 'abc',
	error    : (e) => 'not "abc"',
	rule     : (e) => 'must be "abc"',
})
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=pass_input_demo>
<div class="xsmall  "><pass-input value="abc"></pass-input><button>OK</button></div>
<div class="small   "><pass-input value="abc"></pass-input><button>OK</button></div>
<div class="smaller "><pass-input required></pass-input><button>OK</button></div>
<div class="normal  "><pass-input
		min-len=2 min-score=4 placeholder="Password" id=my_pass
	></pass-input><button>OK</button></div>
<errors for=my_pass type=rules></errors>
<div class="large v">
	<pass-input
		name=password
		value="abc!125"
		min-len=0
		required
		conditions="min-score"
		id=my_pass2
	></pass-input>
	<pass-score for=my_pass2></pass-score>
</div>
<errors for=my_pass2></errors>
<p>Rules:
<errors for=my_pass2 type=rules></errors>
</p>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=num_input_demo>
<div class="xsmall  "><num-input value=-1.51   decimals=2 buttons=up-down    min=0></num-input><button>OK</button></div>
<div class="small   "><num-input value=-1.52   decimals=2 buttons=up-down    min=0></num-input><button>OK</button></div>
<div class="smaller "><num-input value=-1.53   decimals=1 buttons=up-down    min=0></num-input><button>OK</button></div>
<div class="normal  "><num-input value=-1.54   decimals=2 buttons=up-down    min=0></num-input><button>OK</button></div>
<div class="large   "><num-input value=-1.55   decimals=2 buttons=up-down    min=0></num-input><button>OK</button></div>
<div class="xsmall  "><num-input value=-1.51   decimals=2 buttons=plus-minus min=0></num-input><button>OK</button></div>
<div class="small   "><num-input value=-1.52   decimals=2 buttons=plus-minus min=0></num-input><button>OK</button></div>
<div class="smaller "><num-input value=123456  decimals=1 buttons=plus-minus min=0></num-input><button>OK</button></div>
<div class="normal  "><num-input value= 1.54   decimals=0 buttons=plus-minus min=0></num-input><button>OK</button></div>
<div class="large   "><num-input value=abc     decimals=2 buttons=plus-minus min=0></num-input><button>OK</button></div>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=tags_input_demo>
<form id=my_form>
<tags-box tags="Apples Bananas Mangos what do you do when there are too many tags"></tags-box>
<tags-input nowrap value="Apples Bananas Mangos"></tags-input>
<tags-input nowrap value="Apples Bananas Mangos what do you do when there are too many tags"></tags-input>
<d class="ro-collapse-h h-m flex-nowrap shrinks xsmall "><tags-input class="S" value="apples bananas mangos"></tags-input><button>OK</button></d>
<d class="ro-collapse-h h-m flex-nowrap shrinks small  "><tags-input class="S" value="apples bananas mangos"></tags-input><button>OK</button></d>
<d class="ro-collapse-h h-m flex-nowrap shrinks smaller"><tags-input class="S" value="apples bananas mangos"></tags-input><button>OK</button></d>
<d class="ro-collapse-h h-m flex-nowrap shrinks normal "><tags-input class="S" value="Apples Bananas Mangos what do you do when there are too many tags"></tags-input><button>OK</button></d>
<d class="ro-collapse-h h-m flex-nowrap shrinks normal "><tags-input class="S" nowrap value="what do you do when there are too many tags"></tags-input><button>OK</button></d>
<d class="ro-collapse-h h-m flex-nowrap shrinks large  "><tags-input class="S" value="apples bananas mangos" valid-tags="apples bananas mangos" name=t1 format=words fruits-only></tags-input><button>OK</button></d>
<p><button>Submit</button></p>
</form>
<script run>
my_form.on('submit', function() {
	pr(this.json())
	for (const [name,value] of new FormData(this))
		pr('', name, ':', value)
	return false
})
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=list_drag_demo>
<script type="text/x-mustache" id=list_drag_demo_template>
	<div class="b2 p bg1 noselect" style="{{#height}}height: {{height}}{{/height}}">
		<div class="bold nowrap">{{name}}</div>
		{{#phone}}<div class="smaller nowrap">{{phone}}</div>{{/phone}}
		{{#email}}<div class="smaller nowrap">{{email}}</div>{{/email}}
	</div>
</script>
<div class="h-s S shrinks">
<list class="m b p gap" style="border-width: 10px" item_template=list_drag_demo>
	<script>
		let i = 0, a = []
		while (++i <= 200)
			a.push({name: 'John Doe 1.'+i, phone: '+123 456 '+i})
		return a
	</script>
</list>
<list class="m b p-4 gap-4" style="border-width: 10px;" item_template=list_drag_demo>
	<script>
		return [
			{name: 'John Doe 2.1', phone: '+123 456 789', },
			{name: 'John Doe 2.2', phone: '+321 456 789', email: 'bla@bla.com'},
			{name: 'John Doe 2.3', phone: '+213 456 789', email: 'bla@bla.com'},
		]
	</script>
</list>
<list class="S self-h-t m b gap h-l" item_template=list_drag_demo items='[
	{"name": "John Doe 3.1", "phone": "+123 456 789"},
	{"name": "John Doe 3.2", "phone": "+321 456 789", "email": "bla@bla.com"},
	{"name": "John Doe 3.3", "phone": "+213 456 789", "email": "bla@bla.com"}
]'></list>
</div>
<script run>
for (let e of $('list')) {
	e.make_focusable()
	e.make_list_items_focusable()
	e.make_list_drag_elements()
	e.make_list_drop_elements()
}
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=list_search_input_demo>
<list-search-input for=my_list value="an"></list-search-input>
<list id=my_list>
	<d searchable>Apples</d>
	<d searchable>Bananas</d>
	<d searchable>Mangos</d>
</list>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=checklist_demo>
<p>Static checklist</p>
<checklist>
	<d value=a checked>Apples</d>
	<d value=b>Bananas</d>
	<d value=m checked>Mangos</d>
</checklist>

<p>Templated checklist</p>
<checklist>
	<script type="text/x-mustache">
		<d value="{{value}}">{{name}}</d>
	</script>
	<script>
		return [
			{value: 'a', name: 'Apples', checked: true},
			{value: 'b', name: 'Bananas'},
			{value: 'm', name: 'Mangos', checked: true},
		]
	</script>
</checklist>

<script run>
for (let cl of this.parent.$('checklist')) {
	cl.make_list_items_focusable()
	cl.make_focusable()
	cl.on('item_checked', (item, checked) => pr(item.attr('value'), checked))
}
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=dropdown_demo>
<dropdown placeholder="Pick one...">
	<d value=1>Option 1</d>
	<d value=2>Option 2</d>
	<d value=3>Option 3</d>
</dropdown>
<dropdown value="55" align=right required>
	<list>
		<script type="text/x-mustache"><div searchable>{{name}}</div></script>
		<script>
			let a = []
			for (let i = 1; i <= 100; i++)
				a.push({value: i+'', name: 'Option '+i})
			return a
		</script>
	</list>
</dropdown>
<button>OK</button>
<input><button>OK</button>

<dropdown value=wrong>
	<b value=chickens ><span class="fas fa-drumstick-bite"></span> <span searchable>Chickens </span></b>
	<u value=cows style="--fa-display: inline"><span class="fas fa-hat-cowboy"></span> <span searchable>Cows</span></u>
	<i value=grass><i><span searchable>Grass</span></i>
</dropdown>

<dropdown align=right>
	<list>
		<script type="text/x-mustache">
			{{#cat}}
				<div class="noselect v-m bold large label">{{cat}}</div>
			{{/cat}}
			{{#choose}}
				<div class="noselect v-m bold" style="min-height: 5em">Choose...</div>
			{{/choose}}
			{{^cat}}{{^choose}}
				<div class="noselect v-m" style="min-height: 5em">
					<div class="bold nowrap" searchable>{{name}}</div>
					{{#phone}}<div class="smaller nowrap" searchable>{{phone}}</div>{{/phone}}
					{{#email}}<div class="smaller nowrap" searchable>{{email}}</div>{{/email}}
				</div>
			{{/choose}}{{/cat}}
		</script>
		<script>
			return [
				{value: null, choose: 'Choose'},
				{cat: "Foos'n'Bars", focusable: false},
				{value: 'x', name: 'X Foo', phone: '+38 321 654', email: 'x.foo@example.com'},
				{value: 'y', name: 'Y Bar', phone: '+40 123 456', email: 'y.bar@example.com'},
				{cat: "Baz's", focusable: false},
				{value: 'z', name: 'Z Baz', phone: '+36 456 123', email: 'z.baz@example.com'},
			]
		</script>
	</list>
</dropdown>

<script run>
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=check_dropdown_demo>
<form id=my_form>

<p>Basic checklist with default formatting</p>
<check-dropdown name=cd1 value='["3","1"]' required>
	<d value=1 >Bananas</d>
	<d value=2 >Apples</d>
	<d value=3 >Mangos 3 </d>
	<d value=4 >Mangos 4 </d>
	<d value=5 >Mangos 5 </d>
	<d value=6 >Mangos 6 </d>
	<d value=7 >Mangos 7 </d>
	<d value=8 >Mangos 8 </d>
	<d value=9 >Mangos 9 </d>
	<d value=10>Mangos 10</d>
	<d value=11>Mangos 11</d>
	<d value=12>Mangos 12</d>
	<d value=13>Mangos 13</d>
	<d value=14>Mangos 14</d>
</check-dropdown>

<p>Templated checklist</p>
<check-dropdown name=cd2 value='["Mangos","Bananas","Tamarind"]' required>
	<template>
		<d>{{value}}</d>
	</template>
	<script>
		return [
			{value: 'Bananas'},
			{value: 'Apples'},
			{value: 'Mangos'},
		]
	</script>
</check-dropdown>
<button>Submit</button>
</form>

<script run>
my_form.on('submit', function() {
	pr(this.json())
	for (const [name,value] of new FormData(this))
		pr('', name, ':', value)
	return false
})
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=calendar_demo>
<ranges-calendar class="large">
	<range>2022-1-1..2022-1-5</range>
	<range color="hsl(120 50% 50%)">2022-1-5..2022-1-15</range>
	<range focusable=false>2022-2-13..2022-2-15</range>
	<range>2022-3-13..2022-4-4</range>
	<range>2022-4-13..2022-4-25</range>
</ranges-calendar>
<range-calendar value1="2022-1-1" value2="2022-1-5"></range-calendar>
<calendar class="smaller" value="2022-1-1"></calendar>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=time_picker_demo>
<time-picker id=my_tp value="0:59:12" precision=s></time-picker>
<script run>
my_tp.on('input', pr)
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=datetime_picker_demo>
<datetime-picker id=my_dtp value="2345-7-6 00:34:59" precision=s></datetime-picker>
<script run>
my_dtp.on('input', pr)
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=date_input_demo>
<form id=my_form>
<div><date-input       name=d1 placeholder="Birth date"></date-input></div>
<div><date-input       name=d2 value="1900-1-1" placeholder="Birth date"></date-input></div>
<div><timeofday-input  name=d3                           value="0:0:0.1" placeholder="Meet at"></timeofday-input></div>
<div><timeofday-input  name=d4 precision=s               value="0:0:0.1" placeholder="Meet at"></timeofday-input></div>
<div><timeofday-input  name=d5 precision=ms value="0:0:0.1" placeholder="Meet at"></timeofday-input></div>
<div><datetime-input   name=d6 precision=ms value="1900-1-1 0:0:0.1" min="2000-1-1" placeholder="Meet at"></datetime-input></div>
<div><datetime-input   name=d7 precision=ms value="2000-1-1 0:0:0.1" placeholder="Meet at" format=sql></datetime-input></div>
<div><date-range-input
	id=dr1
	name1=d8_1
	name2=d8_2
	value1="2022-1-18"
	value2="2022-2-3"
	min-range="3 days"
	max-range="7 days"
></date-range-input></div>
<button>Submit</button>
</form>
<script run>
my_form.on('submit', function() {
	pr(this.json())
	return false
})
</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=grid_demo>
<script run>

let checked = () => html('<div class="fa fa-check"></div>')

function starts_with_a(s) {
	return s.lower().starts('a') || 'Name must start with "A"'
}

let fields = [
	{name: 'id'        , w:  50, min_w:  30, type: 'number', editable: false},
	{name: 'index'     , w:  50, type: 'number', editable: false},
	{name: 'active'    , w:  30, type: 'bool', true_text: checked, false_text: ''},
	{name: 'name'      , w: 150, min_w:  50, max_w: 400, validate: starts_with_a},
	{name: 'parent_id' , w:  50, min_w:  50, type: 'number', editable: false, focusable: false},
	{name: 'random_num', w: 130, type: 'number',
		label: 'Random Number',
		info: 'Just a random number\ngenerated here on the client'},
	{name: 'date'      , w: 120, type: 'time'},
]

let rows = []

for (let i = 0; i <= 10000; i++) {
	let r = random()
	let id         = i
	let name       = 'record '+i
	let parent_id  = i > 1 ? (i-1) % 3 : null // floor((random() * i))
	let random_num = floor(r * 1e6)
	let random_date = snap(r * 80 * 365 * 24 * 3600, 24 * 3600)
	let active = i % 5 == 0
	let row = [id, id, active, name, parent_id, random_num, random_date]
	row.focusable = true // i % 100 >= 85
	rows.push(row)
}

g = grid({
	id: 'my_grid',
	tabname: 'My Grid',
	rowset: {
		fields: fields,
		rows: rows,
		pk: 'id',
		parent_col: 'parent_id',
		index_col: 'index',
	},
	order_by: 'active name:desc',
	tree_col: 'name',
	//can_edit: false,
	can_change_header_visibility: true,
	//can_focus_cells: false,
	//order_by: 'parent_id name:desc',
	can_move_rows: true,
	//enter_edit_on_click_focused: false,
	//can_change_parent: false,
	filters_visible: true,
})

result.add(g)

</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=html_grid_demo>
<grid id=my_html_grid>
	<col-attrs for=id type=number></col-attrs>
	<rowset pk=id can_change_rows=false>
		<field name=id   ></field>
		<field name=name ></field>
		<field name=desc ></field>
		<row :id=1 name=Foo desc="Le Foo"></row>
		<row :id=2 name=Bar desc="Le Bar"></row>
		<row :id=3 name=Baz desc="Le Baz"></row>
	</rowset>
</grid>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=charts_demo>
<vsplit>
	<tabs>
		<grid id=g tabname=Output>
			<rowset>
				<field name=date    type=date    ></field>
				<field name=country              ></field>
				<field name=sector               ></field>
				<field name=output  type=number  ></field>
				<row  date="2020-01-01"  country=Algeria  sector=Energy    output=" 80" ></row>
				<row  date="2021-01-01"  country=Algeria  sector=Chickens  output="100" ></row>
				<row  date="2022-01-01"  country=Algeria  sector=Chickens  output="150" ></row>
				<row  date="2020-01-01"  country=Canada   sector=Chickens  output=" 20" ></row>
				<row  date="2021-01-01"  country=Canada   sector=Geese     output=" 10" ></row>
				<row  date="2021-01-01"  country=Canada   sector=Geese     output="120" ></row>
				<row  date="2022-01-01"  country=Canada   sector=Geese     output=" 50" ></row>
				<row  date="2020-01-01"  country=Croatia  sector=Science   output="100" ></row>
				<row  date="2020-01-01"  country=Croatia  sector=Chickens  output="200" ></row>
				<row  date="2021-01-01"  country=Croatia  sector=Energy    output="150" ></row>
				<row  date="2021-01-01"  country=Croatia  sector=Energy    output="120" ></row>
				<row  date="2022-01-01"  country=Croatia  sector=Chickens  output="180" ></row>
				<row  date="2022-01-01"  country=Croatia  sector=Energy    output=" 50" ></row>
			</rowset>
		</grid>
		<div class="m-4" tabname="Empty">This is empty to disconnect the grid.</div>
	</tabs>
	<tabs tabs_side=left>
		<chart tabname=Pie nav=g
			shape=pie
			sum_cols=output
			group_cols="country sector"
		></chart>
		<chart tabname=Stack nav=g
			shape=stack
			sum_cols=output
			group_cols="sector country"
		></chart>
		<chart tabname="Areas" nav=g
			shape=areas
			sum_cols=output
			split_cols=country
			group_cols="date/0/month/1"
		></chart>
		<chart tabname="Areas+Dots" nav=g
			shape=areas_dots
			sum_cols=output
			split_cols=country
			group_cols="date/0/month/1"
		></chart>
		<chart tabname="Lines" nav=g
			shape=lines
			sum_cols=output
			split_cols=country
			group_cols="date/0/month/1"
		></chart>
		<chart tabname="Lines+Dots" nav=g
			shape=lines_dots
			sum_cols=output
			split_cols=country
			group_cols="date/0/month/1"
		></chart>
		<chart tabname=Columns nav=g
			shape=columns
			sum_cols=output
			split_cols="country sector"
			group_cols="date/0/month/1"
		></chart>
		<chart tabname=Bars nav=g
			shape=bars
			sum_cols=output
			split_cols="country sector"
			group_cols="date/0/month/1"
		></chart>
	</tabs>
</vsplit>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=form_demo>
<form id=my_form class="g-h ga-m g-2col gap-x" style="grid-template-columns: 5em auto">
	<checkbox name=check1 checked-value=c1 class="self-h-c" id=check1></checkbox><label for=check1>Check me baby</label>
	<radio  name=radio1 checked-value=r1 class="self-h-c" id=radio1 group=g1></radio><label for=radio1>Pick me</label>
	<radio  name=radio1 checked-value=r2 class="self-h-c" id=radio2 group=g1 checked></radio><label for=radio2>No, pick me!</label>
	<toggle name=toggle1 class="self-h-c" id=toggle1></toggle><label for=toggle1>Toggle me</label>
	<d></d><label for=input1>Label of next input</label>
	<info class="self-h-c">
		This here is just a simple input.<br>
		Click on the label to focus it.
	</info><input name=input1 id=input1></input>
	<d></d><text-input name=t1 required placeholder="Just text"></text-input>
	<d></d><textarea-input name=ta1 required placeholder="Put here&#10;some text"></textarea-input>
	<d></d><d class="h b-collapse-h ro-collapse-h w-input">
			<pass-input name=pass1 value="" placeholder="Password"></pass-input><button>OK</button></div>
		</d>
	<d></d><num-input name=n1 value=-1.54 decimals=2 buttons=up-down></num-input>
	<d></d><d class=v>
		<num-input id=num1 name=n2 value=-5 min=1 max=10 buttons=plus-minus></num-input>
		<errors for=num1 type=rules></errors>
	</d>
	<d></d>
	<style>
		.tags-input-group {
			width: var(--w-input);
		}
	</style>
	<tags-input id=tags_input1 name=tags1 nowrap value="Apples Bananas Mangos" valid-tags="Apples Bananas"></tags-input>
	<d></d><dropdown name=dd1 value=ban>
		<d value=app searchable>Apples</d>
		<d value=ban searchable>Bananas</d>
		<d value=man searchable>Mangos</d>
	</dropdown>
	<d></d><select-button name=sel1 value=ban>
		<d value=man>Mangos</d>
		<d value=ban>Bananas</d>
		<d value=app>Apples</d>
	</select-button>
	<d></d><date-input
		name=date1
		value="2022-1-18"
		placeholder="Birth date"
	></date-input>
	<d></d><timeofday-input
		name=time1
		value="00:00:00.2"
		precision=s placeholder="Meet at"
	></timeofday-input>
	<d></d><datetime-input
		name=datetime1
		value="2022-1-18 12:34:56"
		precision=s
		placeholder="Meet at"
	></datetime-input>
	<d></d><date-range-input
		name1=daterange1_from name2=daterange1_to
		value1="2022-1-18" value2="2022-2-3"
	></date-range-input>
	<d></d><slider name=slider1 min=0.1 max=0.9 value=0.75></slider>
	<d></d><range-slider name1=slider2_from name2=slider2_to
		min=10 max=90 from=0 to=100 value1=20 value2=80 decimals=0></range-slider>
	<d></d><button id=b1 bare type="button">CANCEL</button>
	<d></d><d class="h gap-x S">
		<button id=b2 class="S" primary icon="fa fa-save" name=action value=save>Save</button>
		<button id=b3 class="S" danger icon="fa fa-trash" name=action value=delete>Delete</button>
	</d>
</form>
<script run>
my_form.on('submit', function(ev) {
	pr('Submit:', ev.submitter && ev.submitter.value)
	pr(this.json())
	for (const [name,value] of new FormData(this))
		pr('', name, ':', value)
	return false
})

listen('validate', function(e) {

})

</script>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=list_nav_demo>
<list class="gap-y">
	<script type="text/x-mustache">
		<d class="b p gap-x g-2col">
			<d class="label">ID:          </d><d class="bold">{{id}}</d>
			<d class="label">Name:        </d><d class="bold">{{name}}</d>
			<d class="label">Description: </d><d class="bold">{{desc}}</d>
		</d>
	</script>
	<nav>
		<rowset pk=id>
			<field name=id   ></field>
			<field name=name ></field>
			<field name=desc ></field>
			<row :id=1 name=Foo desc="Le Foo"></row>
			<row :id=2 name=Bar desc="Le Bar"></row>
			<row :id=3 name=Baz desc="Le Baz"></row>
		</rowset>
	</nav>
</list>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=dropdown_list_nav_demo>
<rowset id=rowset_my_rowset pk=id>
	<field name=id      ></field>
	<field name=name    ></field>
	<field name=surname ></field>
	<row :id=1 name=Foo surname="Le Foo"></row>
	<row :id=2 name=Bar surname="Le Bar"></row>
	<row :id=3 name=Baz surname="Le Baz"></row>
</rowset>
<dropdown value="2" value-key=id align=right>
	<list>
		<script type="text/x-mustache"><d searchable>{{name}} {{surname}}</d></script>
		<nav rowset=my_rowset wait=1>
		</nav>
	</list>
</dropdown>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=grid_inputs_demo>
<split fixed-size=410>
	<grid id=my_grid>
		<rowset pk=id>
			<field
				name=id
				label="The ID"
				type=number
			></field>
			<field
				name=name
				label="The Name"
				max-len=5
				placeholder="Put Your Name Here"
			></field>
			<field
				name=active
				type=bool
			></field>
			<field
				name=min_price
				type=number
				min=10
				max=90
				from=0
				to=100
			></field>
			<field
				name=max_price
				type=number
				min=10
				max=90
				from=0
				to=100
			></field>
			<field
				name=fruit
				type=enum
				enum_values="apple banana"
			></field>
			<field
				name=start_date
				type=date
				min="2020-01-01"
				max="2021-01-01"
			></field>
			<field
				name=end_date
				type=date
				min="2021-01-01"
				max="2022-01-01"
			></field>

			<row></row>
			<row
				:id=1
				name="Errors"
				active=wrong
				min_price=-10
				max_price=200
				fruit="tomato"
				start_date="wrong"
				end_date="1990-01-01"
			></row>
			<row
				:id=3
				name="Good"
				active
				min_price=40
				max_price=60
				fruit="apple"
				start_date="2021-01-01"
				end_date="2021-02-01"
			></row>

		</rowset>
	</grid>
	<div class="m-l-2 g-t ga-m g-2col gap-x">
		<label          nav=my_grid col=id                  ></label>
		<num-input      nav=my_grid col=id buttons=up-down  ></num-input>

		<label          nav=my_grid col=name ></label>
		<text-input     nav=my_grid col=name ></text-input>

		<label          nav=my_grid col=name ></label>
		<textarea-input nav=my_grid col=name ></textarea-input>

		<label          nav=my_grid col=active ></label>
		<checkbox       nav=my_grid col=active ></checkbox>
		<label          nav=my_grid col=active ></label>
		<toggle         nav=my_grid col=active ></toggle>

		<label          nav=my_grid col=min_price ></label>
		<slider         nav=my_grid col=min_price ></slider>
		<label          nav=my_grid col=max_price ></label>
		<slider         nav=my_grid col=max_price ></slider>
		<label          for=my_dr1 >Price Range</label>
		<range-slider   nav=my_grid col1=min_price col2=max_price id=my_pr1 ></range-slider>

		<radio          nav=my_grid id=my_fruit1 col=fruit checked-value=apple  ></radio>
		<label          for=my_fruit1 >Pick an apple</label>
		<radio          nav=my_grid id=my_fruit2 col=fruit checked-value=banana ></radio>
		<label          for=my_fruit2>Pick a banana</label>

		<label          nav=my_grid col=fruit></label>
		<select-button  nav=my_grid col=fruit></select-button>

		<label          nav=my_grid col=start_date ></label>
		<date-input     nav=my_grid col=start_date ></date-input>
		<label          nav=my_grid col=end_date   ></label>
		<datetime-input nav=my_grid col=end_date   ></datetime-input>
		<label          for=my_dr1>Date Range</label>
		<date-range-input nav=my_grid col1=start_date col2=end_date id=my_dr1 ></date-range-input>
	</div>
</split>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=lookup_demo>
<rowset id=rowset_lang pk=lang name_col=name wait=1>
	<field name=lang></field>
	<field name=name></field>
	<row lang=en name=English></row>
	<row lang=es name=Spanish></row>
	<row lang=it name=Italian></row>
</rowset>
<grid id=my_grid>
	<rowset>
		<field name=user                       ></field>
		<field name=lang1 lookup_rowset=lang   ></field>
		<field name=lang2 lookup_rowset=lang   ></field>
		<row user=Foo lang1=en ></row>
		<row user=Bar lang1=it lang2=es></row>
		<row user=Baz          lang2=en></row>
		<row user=Wrong lang1=xx lang2=yy></row>
	</rowset>
</grid>
<dropdown nav=my_grid col=lang1></dropdown>
<dropdown nav=my_grid col=lang2></dropdown>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=nav_params_demo>
<grid id=makers_grid>
	<rowset>
		<field name=maker></field>
		<row maker=Honda  ></row>
		<row maker=Toyota ></row>
	</rowset>
</grid>
<grid id=colors_grid>
	<rowset>
		<field name=color  ></field>
		<field name=accent ></field>
		<row color=Gray  accent=Gray  ></row>
		<row color=Gray  accent=Black ></row>
		<row color=Black accent=Gray  ></row>
		<row color=Black accent=Black ></row>
	</rowset>
</grid>
<grid id=models_grid params="
		makers_grid.maker=maker
		colors_grid.color=color,accent=accent
	">
	<rowset>
		<field name=maker  ></field>
		<field name=model  ></field>
		<field name=color  ></field>
		<field name=accent ></field>
		<row maker=Honda   model=Accord   color=Gray   accent=Gray ></row>
		<row maker=Honda   model=Civic    color=Black  accent=Gray ></row>
		<row maker=Toyota  model=Corolla  color=Gray   accent=Gray ></row>
		<row maker=Toyota  model=Prius    color=Black  accent=Gray ></row>
	</rowset>
</grid>
</xmp>

<!--------------------------------------------------------------------------->

<xmp id=nodes_changed_demo>
<d id=my></d>
<script run>
	my.on('nodes_changed', function() {
		pr('NODES CHANGED')
	})
	runafter(0, function() {
		my.add(div())
		my.add(div())
	})
</script>
</xmp>

<!--------------------------------------------------------------------------->

</body>
</html>
